<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>STA 3311 Sports Analytics II - 16&nbsp; DBSCAN</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./17_MLP.html" rel="next">
<link href="./15_SVM.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="webex.css">
</head>
<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./16_DBSCAN.html"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">DBSCAN</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./"></a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_Intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Intro to Data Manipulation with <code>dplyr</code></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_Stringr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">String, Dates, and Joins</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_Tidymodels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Introduction to Tidymodels</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_Regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Linear Regression with Regularization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_Logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Logistic Regression with Regularization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_Mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Mixed Effects Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_Data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Obtaining Sport Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_Web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Web Scraping with Rvest</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09_ML.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introduction to Machine Learning</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_Random.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Random Forests</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_Spatial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Visualization of Player Tracking Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12_knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">K-Nearest Neighbors</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13_clustering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Clustering</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14_dimension.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Dimensionality Reduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15_SVM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Support Vector Machines</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16_DBSCAN.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">DBSCAN</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17_MLP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Multi-Layer Perceptron</span></span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#understanding-dbscan" id="toc-understanding-dbscan" class="nav-link active" data-scroll-target="#understanding-dbscan"><span class="header-section-number">16.1</span> Understanding DBSCAN</a>
  <ul class="collapse">
<li><a href="#the-epsilon-neighborhood" id="toc-the-epsilon-neighborhood" class="nav-link" data-scroll-target="#the-epsilon-neighborhood"><span class="header-section-number">16.1.1</span> The <span class="math inline">\(\epsilon\)</span> Neighborhood</a></li>
  <li><a href="#core-border-and-noise-points" id="toc-core-border-and-noise-points" class="nav-link" data-scroll-target="#core-border-and-noise-points"><span class="header-section-number">16.1.2</span> Core, Border, and Noise Points</a></li>
  <li><a href="#cluster-formation" id="toc-cluster-formation" class="nav-link" data-scroll-target="#cluster-formation"><span class="header-section-number">16.1.3</span> Cluster Formation</a></li>
  <li><a href="#advantages-of-dbscan" id="toc-advantages-of-dbscan" class="nav-link" data-scroll-target="#advantages-of-dbscan"><span class="header-section-number">16.1.4</span> Advantages of DBSCAN</a></li>
  <li><a href="#challenges-in-parameter-selection" id="toc-challenges-in-parameter-selection" class="nav-link" data-scroll-target="#challenges-in-parameter-selection"><span class="header-section-number">16.1.5</span> Challenges in Parameter Selection</a></li>
  </ul>
</li>
  <li>
<a href="#practical-implementation-using-tidymodels-and-r" id="toc-practical-implementation-using-tidymodels-and-r" class="nav-link" data-scroll-target="#practical-implementation-using-tidymodels-and-r"><span class="header-section-number">16.2</span> Practical Implementation Using Tidymodels and R</a>
  <ul class="collapse">
<li><a href="#conducting-dbscan" id="toc-conducting-dbscan" class="nav-link" data-scroll-target="#conducting-dbscan"><span class="header-section-number">16.2.1</span> Conducting DBSCAN</a></li>
  <li><a href="#visualizing-results" id="toc-visualizing-results" class="nav-link" data-scroll-target="#visualizing-results"><span class="header-section-number">16.2.2</span> Visualizing Results</a></li>
  </ul>
</li>
  <li><a href="#parameter-tuning" id="toc-parameter-tuning" class="nav-link" data-scroll-target="#parameter-tuning"><span class="header-section-number">16.3</span> Parameter Tuning</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">16.4</span> Conclusion</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">16</span>&nbsp; <span class="chapter-title">DBSCAN</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><blockquote class="blockquote">
<p>“Mike Tyson is a good boxer, but he is not the best fighter. I am the best fighter.” - Royce Gracie</p>
</blockquote>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="pics/gracie.jpg" class="img-fluid figure-img" width="200"></p>
<figcaption class="figure-caption">At the first Ultimate Fighting Championship (UFC) on Nov.&nbsp;12, 1993, boxer Art Jimmerson was so confident that he would win that he wore one glove. He believed he could easily keep his opponent away by using his jab. Brazilian Jiu-Jitsu fighter, Royce Gracie, forced Jimmerson to tap out in two minutes and 18 seconds in the first round of the tournament. Gracie would go on to be the first UFC Champion.</figcaption></figure>
</div>
<p>In sports analytics, understanding underlying patterns within data can offer valuable insights into player behavior, team strategies, and overall game dynamics. Clustering techniques are commonly utilized for this purpose, grouping similar observations without pre-specified categories or labels. Among the variety of clustering methods, Density-Based Spatial Clustering of Applications with Noise (DBSCAN) has gained considerable popularity due to its ability to uncover meaningful patterns while robustly handling noise and outliers. Unlike traditional clustering methods, DBSCAN identifies clusters based on the density of data points, making it particularly suitable for datasets where clusters are irregularly shaped or densities vary significantly.</p>
<section id="understanding-dbscan" class="level2" data-number="16.1"><h2 data-number="16.1" class="anchored" data-anchor-id="understanding-dbscan">
<span class="header-section-number">16.1</span> Understanding DBSCAN</h2>
<p>DBSCAN, which stands for <strong>Density-Based Spatial Clustering of Applications with Noise</strong>, is a powerful unsupervised learning algorithm particularly well-suited for clustering tasks involving complex geometries or datasets with noise. Unlike k-means or hierarchical clustering, DBSCAN does not require the analyst to specify the number of clusters ahead of time. Instead, it discovers clusters based on the density of data points in the feature space.</p>
<p>The key idea behind DBSCAN is that a cluster is a region of the space where data points are densely packed together, and separated from other clusters by areas of low density. To formalize this notion of density, DBSCAN uses two main parameters: <strong><span class="math inline">\(\epsilon\)</span> (epsilon)</strong> and <strong>MinPts (minimum points)</strong>.</p>
<section id="the-epsilon-neighborhood" class="level3" data-number="16.1.1"><h3 data-number="16.1.1" class="anchored" data-anchor-id="the-epsilon-neighborhood">
<span class="header-section-number">16.1.1</span> The <span class="math inline">\(\epsilon\)</span> Neighborhood</h3>
<p>The <span class="math inline">\(\epsilon\)</span> parameter defines the <strong>radius of the neighborhood</strong> around a data point. This radius is used to identify which other points are considered close enough to be neighbors. A small <span class="math inline">\(\epsilon\)</span> value makes the neighborhood very strict, while a large <span class="math inline">\(\epsilon\)</span> may cause distinct clusters to merge. Choosing <span class="math inline">\(\epsilon\)</span> effectively determines the scale at which the algorithm views the structure of the data.</p>
</section><section id="core-border-and-noise-points" class="level3" data-number="16.1.2"><h3 data-number="16.1.2" class="anchored" data-anchor-id="core-border-and-noise-points">
<span class="header-section-number">16.1.2</span> Core, Border, and Noise Points</h3>
<p>Using the <span class="math inline">\(\epsilon\)</span> neighborhood, DBSCAN classifies each data point into one of three categories:</p>
<ul>
<li><p><strong>Core points</strong> are points that have at least <strong>MinPts</strong> points (including themselves) within their <span class="math inline">\(\epsilon\)</span>-radius. These points are considered to be in dense regions and thus serve as the seeds for building clusters.</p></li>
<li><p><strong>Border points</strong> are points that have fewer than MinPts points within their <span class="math inline">\(\epsilon\)</span>ε-radius but are within the <span class="math inline">\(\epsilon\)</span>-radius of a core point. These points belong to the cluster of the core point but are not themselves dense enough to start a new cluster.</p></li>
<li><p><strong>Noise points</strong> (also called outliers) are points that are neither core points nor border points. These are considered to be in low-density regions and are not assigned to any cluster.</p></li>
</ul></section><section id="cluster-formation" class="level3" data-number="16.1.3"><h3 data-number="16.1.3" class="anchored" data-anchor-id="cluster-formation">
<span class="header-section-number">16.1.3</span> Cluster Formation</h3>
<p>The clustering process in DBSCAN begins by selecting an arbitrary point in the dataset. If this point is a core point (i.e., it has at least MinPts neighbors within <span class="math inline">\(\epsilon\)</span>), a new cluster is started. All points that are density-reachable from the core point are added to this cluster. A point <span class="math inline">\(p\)</span> is said to be <strong>directly density-reachable</strong> from a point <span class="math inline">\(q\)</span> if it lies within the <span class="math inline">\(\epsilon\)</span>-radius of <span class="math inline">\(q\)</span>, and <span class="math inline">\(q\)</span> is a core point. Furthermore, a point <span class="math inline">\(p\)</span> is <strong>density-reachable</strong> from <span class="math inline">\(q\)</span> if there is a sequence of points <span class="math inline">\(p_1, p_2, ..., p_k\)</span> where <span class="math inline">\(p_1 = q\)</span>, <span class="math inline">\(p_k = p\)</span>, and each <span class="math inline">\(p_{i+1}\)</span> is directly density-reachable from <span class="math inline">\(p_i\)</span>.</p>
<p>This expansion process continues recursively until no more points can be added to the cluster. The algorithm then moves on to the next unvisited point and repeats the process. If a point is not density-reachable from any core point, it is labeled as noise.</p>
</section><section id="advantages-of-dbscan" class="level3" data-number="16.1.4"><h3 data-number="16.1.4" class="anchored" data-anchor-id="advantages-of-dbscan">
<span class="header-section-number">16.1.4</span> Advantages of DBSCAN</h3>
<p>DBSCAN possesses several important strengths that make it particularly appealing for sports analytics and other real-world applications:</p>
<ul>
<li><p><strong>Arbitrary-Shaped Clusters</strong>: Unlike k-means, which assumes spherical clusters due to the use of centroids, DBSCAN can find clusters of any shape as long as they are dense enough. This is especially useful in spatial datasets, such as shot charts or movement trajectories.</p></li>
<li><p><strong>Outlier Detection</strong>: By design, DBSCAN identifies and labels noise points, which can be interpreted as outliers. In sports contexts, these may correspond to rare events or unusual plays, which might warrant special attention.</p></li>
<li><p><strong>No Need to Specify k</strong>: Unlike k-means or Gaussian Mixture Models, DBSCAN does not require the number of clusters to be specified in advance. This allows it to adapt to the structure of the data more flexibly.</p></li>
</ul></section><section id="challenges-in-parameter-selection" class="level3" data-number="16.1.5"><h3 data-number="16.1.5" class="anchored" data-anchor-id="challenges-in-parameter-selection">
<span class="header-section-number">16.1.5</span> Challenges in Parameter Selection</h3>
<p>Despite its advantages, DBSCAN is sensitive to the choice of <span class="math inline">\(\epsilon\)</span> and MinPts. If <span class="math inline">\(\epsilon\)</span> is too small, many points will be labeled as noise. If <span class="math inline">\(\epsilon\)</span> is too large, distinct clusters may be merged together. Similarly, setting MinPts too low may lead to spurious clusters formed from noise, while setting it too high may prevent any clusters from forming.</p>
<p>A common strategy to select <span class="math inline">\(\epsilon\)</span> is to plot the distances to the <span class="math inline">\(k\)</span> nearest neighbors of each point (where <span class="math inline">\(k = MinPts - 1\)</span>) and look for a sharp change, or “elbow,” in the plot. This helps to identify a threshold distance that distinguishes between dense and sparse regions of the data.</p>
</section></section><section id="practical-implementation-using-tidymodels-and-r" class="level2" data-number="16.2"><h2 data-number="16.2" class="anchored" data-anchor-id="practical-implementation-using-tidymodels-and-r">
<span class="header-section-number">16.2</span> Practical Implementation Using Tidymodels and R</h2>
<p>In R, the tidymodels framework provides intuitive tools to carry out DBSCAN clustering efficiently. For illustration, consider player shot location data from the <code>hoopR</code> package available on CRAN. We use DBSCAN to cluster shot locations, revealing preferred shooting zones and identifying unusual shot attempts.</p>
<p>First, ensure the required packages are installed and loaded:</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org">tidymodels</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sportsdataverse/hoopR">hoopR</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Load a dataset of shot locations using the <code>hoopR</code> package. The following example fetches shot data for Baylor during the 2021 National Championship Game:</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">shots_data</span> <span class="op">=</span> <span class="fu"><a href="https://hoopR.sportsdataverse.org/reference/espn_mbb_pbp.html">espn_mbb_pbp</a></span><span class="op">(</span>game_id <span class="op">=</span> <span class="fl">401310865</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">shooting_play</span><span class="op">==</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">team_id</span><span class="op">==</span><span class="fl">239</span><span class="op">)</span> <span class="co">#239 is Baylor</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we select only essential columns representing shot location coordinates:</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">shots_df</span> <span class="op">=</span> <span class="va">shots_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">coordinate_x</span>, <span class="va">coordinate_y</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="conducting-dbscan" class="level3" data-number="16.2.1"><h3 data-number="16.2.1" class="anchored" data-anchor-id="conducting-dbscan">
<span class="header-section-number">16.2.1</span> Conducting DBSCAN</h3>
<p>In tidymodels, clustering workflows are straightforward. First, we define a recipe to preprocess data (here, scaling is beneficial as DBSCAN uses distance calculations):</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">shots_recipe</span> <span class="op">=</span> <span class="fu">recipe</span><span class="op">(</span><span class="op">~</span> <span class="va">coordinate_x</span> <span class="op">+</span> <span class="va">coordinate_y</span>, data <span class="op">=</span> <span class="va">shots_df</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">step_normalize</span><span class="op">(</span><span class="fu">all_predictors</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">prep</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">=</span> <span class="va">shots_recipe</span> <span class="op">|&gt;</span> <span class="fu">bake</span><span class="op">(</span>new_data <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We then define the DBSCAN model, specifying the parameters <span class="math inline">\(\epsilon\)</span> (<code>eps</code>) and MinPts (<code>minPts</code>). Initially, you may choose exploratory parameter values to understand their impact:</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mhahsler/dbscan">dbscan</a></span><span class="op">)</span></span>
<span><span class="va">fitted_model</span> <span class="op">=</span> <span class="va">dat</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/dbscan/man/dbscan.html">dbscan</a></span><span class="op">(</span>eps<span class="op">=</span><span class="fl">0.5</span>, minPts<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Extract cluster assignments from the fitted model:</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">shots_clustered</span> <span class="op">=</span> <span class="va">shots_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>cluster <span class="op">=</span> <span class="va">fitted_model</span> <span class="op">|&gt;</span> <span class="fu">pluck</span><span class="op">(</span><span class="st">"cluster"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">shots_clustered</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 85 × 3
   coordinate_x coordinate_y cluster
          &lt;dbl&gt;        &lt;dbl&gt;   &lt;int&gt;
 1        -35.8            3       1
 2        -36.8            0       1
 3        -27.8           10       1
 4        -26.8            6       1
 5        -40.8           -2       1
 6        -23.8           17       2
 7        -39.8            2       1
 8        -40.8            3       1
 9        -39.8            6       1
10        -34.8          -16       0
# ℹ 75 more rows</code></pre>
</div>
</div>
<p>The resulting cluster variable identifies each shot’s cluster membership. Shots labeled as “0” correspond to noise.</p>
</section><section id="visualizing-results" class="level3" data-number="16.2.2"><h3 data-number="16.2.2" class="anchored" data-anchor-id="visualizing-results">
<span class="header-section-number">16.2.2</span> Visualizing Results</h3>
<p>Visualizing the clusters helps in interpreting results. The following plot clearly distinguishes clusters from noise, providing insights into preferred shooting locations and irregular attempts:</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">shots_clustered</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">coordinate_x</span>, y <span class="op">=</span> <span class="va">coordinate_y</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_fixed</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"DBSCAN Clustering of Shot Locations"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Baylor in the National Championship"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Court X Coordinate"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Court Y Coordinate"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Cluster ID"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="16_DBSCAN_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="576"></p>
</div>
</div>
<p>Interpreting the plot can reveal distinct shot zones, such as favored three-point shooting areas or mid-range positions. Shots identified as noise might represent uncommon attempts or last-second forced shots.</p>
</section></section><section id="parameter-tuning" class="level2" data-number="16.3"><h2 data-number="16.3" class="anchored" data-anchor-id="parameter-tuning">
<span class="header-section-number">16.3</span> Parameter Tuning</h2>
<p>Selecting optimal DBSCAN parameters (<span class="math inline">\(\epsilon\)</span> and MinPts) is critical for meaningful clustering. Typically, exploratory analysis guides parameter choices. A common approach is using a k-nearest neighbor (k-NN) distance plot to choose an appropriate <span class="math inline">\(\epsilon\)</span>:</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mhahsler/dbscan">dbscan</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/dbscan/man/kNNdist.html">kNNdistplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">shots_df</span><span class="op">)</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="16_DBSCAN_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="576"></p>
</div>
</div>
<p>In the plot above, look for an elbow in the distance plot to inform an appropriate <span class="math inline">\(\epsilon\)</span> value. Adjust <code>eps</code> and <code>min_pts</code> accordingly based on domain expertise and visualization results.</p>
<p>In our example, the elbow appears around 0.8 or 0.9. Let’s use <span class="math inline">\(\epsilon=0.85\)</span>. We will set <code>minPts</code> to the number of nearest neighbors we chose when we made the plot to determine <span class="math inline">\(\epsilon\)</span> above.</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fitted_model</span> <span class="op">=</span> <span class="va">dat</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/dbscan/man/dbscan.html">dbscan</a></span><span class="op">(</span>eps<span class="op">=</span><span class="fl">0.85</span>, minPts<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">shots_clustered</span> <span class="op">=</span> <span class="va">shots_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>cluster <span class="op">=</span> <span class="va">fitted_model</span> <span class="op">|&gt;</span> <span class="fu">pluck</span><span class="op">(</span><span class="st">"cluster"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">shots_clustered</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">coordinate_x</span>, y <span class="op">=</span> <span class="va">coordinate_y</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_fixed</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"DBSCAN Clustering of Shot Locations"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Baylor in the National Championship"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Court X Coordinate"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Court Y Coordinate"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Cluster ID"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="16_DBSCAN_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="576"></p>
</div>
</div>
<p>If we set <span class="math inline">\(k=3\)</span> in the kNN distance plot, we obtain</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/dbscan/man/kNNdist.html">kNNdistplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">shots_df</span><span class="op">)</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="16_DBSCAN_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="576"></p>
</div>
</div>
<p>Here the elbow is closer to 0.6. Therefore, we will set <code>minPts</code> to 3 and <code>eps</code> to 0.6.</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fitted_model</span> <span class="op">=</span> <span class="va">dat</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/dbscan/man/dbscan.html">dbscan</a></span><span class="op">(</span>eps<span class="op">=</span><span class="fl">0.6</span>, minPts<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">shots_clustered</span> <span class="op">=</span> <span class="va">shots_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>cluster <span class="op">=</span> <span class="va">fitted_model</span> <span class="op">|&gt;</span> <span class="fu">pluck</span><span class="op">(</span><span class="st">"cluster"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">shots_clustered</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">coordinate_x</span>, y <span class="op">=</span> <span class="va">coordinate_y</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_fixed</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"DBSCAN Clustering of Shot Locations"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Baylor in the National Championship"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Court X Coordinate"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Court Y Coordinate"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Cluster ID"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="16_DBSCAN_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="576"></p>
</div>
</div>
</section><section id="conclusion" class="level2" data-number="16.4"><h2 data-number="16.4" class="anchored" data-anchor-id="conclusion">
<span class="header-section-number">16.4</span> Conclusion</h2>
<p>DBSCAN provides a robust, density-based clustering approach ideal for sports analytics applications, particularly when dealing with irregular spatial patterns and noise. Its flexibility, minimal assumptions, and intuitive interpretation capabilities make DBSCAN a powerful tool for analysts to uncover meaningful patterns in sports data.</p>
<p>Using tidymodels and readily available sports datasets like those provided by <code>hoopR</code>, practitioners can efficiently apply DBSCAN clustering, visualize insightful results, and inform strategic decisions within sports contexts.</p>


</section></main><!-- /main --><script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Show Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Show Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  update_total_correct();
}

</script><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./15_SVM.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Support Vector Machines</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./17_MLP.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Multi-Layer Perceptron</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">STA 3311</div>
  </div>
</footer>


</body></html>