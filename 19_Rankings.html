<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>STA 3311 Sports Analytics II - 19&nbsp; Intro to Rankings</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./18_Fitting.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="webex.css">
</head>
<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./19_Rankings.html"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Intro to Rankings</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./"></a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_Intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Intro to Data Manipulation with <code>dplyr</code></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_Stringr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">String, Dates, and Joins</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_Tidymodels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Introduction to Tidymodels</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_Regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Linear Regression with Regularization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_Logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Logistic Regression with Regularization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_Mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Mixed Effects Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_Data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Obtaining Sport Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_Web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Web Scraping with Rvest</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09_ML.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introduction to Machine Learning</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_Random.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Random Forests</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_Spatial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Visualization of Player Tracking Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12_knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">K-Nearest Neighbors</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13_clustering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Clustering</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14_dimension.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Dimensionality Reduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15_SVM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Support Vector Machines</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16_DBSCAN.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">DBSCAN</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17_MLP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Multi-Layer Perceptron</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18_Fitting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Fitting and Overfitting</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19_Rankings.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Intro to Rankings</span></span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">19.1</span> Introduction</a></li>
  <li>
<a href="#win-percentage-ranking" id="toc-win-percentage-ranking" class="nav-link" data-scroll-target="#win-percentage-ranking"><span class="header-section-number">19.2</span> Win Percentage Ranking</a>
  <ul class="collapse">
<li><a href="#concept" id="toc-concept" class="nav-link" data-scroll-target="#concept"><span class="header-section-number">19.2.1</span> Concept</a></li>
  <li><a href="#example-full-round-robin-tennis-tournament" id="toc-example-full-round-robin-tennis-tournament" class="nav-link" data-scroll-target="#example-full-round-robin-tennis-tournament"><span class="header-section-number">19.2.2</span> Example: Full Round Robin — Tennis Tournament</a></li>
  </ul>
</li>
  <li>
<a href="#points-based-systems" id="toc-points-based-systems" class="nav-link" data-scroll-target="#points-based-systems"><span class="header-section-number">19.3</span> Points-Based Systems</a>
  <ul class="collapse">
<li><a href="#concept-1" id="toc-concept-1" class="nav-link" data-scroll-target="#concept-1"><span class="header-section-number">19.3.1</span> Concept</a></li>
  <li><a href="#example-soccer-mini-league" id="toc-example-soccer-mini-league" class="nav-link" data-scroll-target="#example-soccer-mini-league"><span class="header-section-number">19.3.2</span> Example: Soccer Mini-League</a></li>
  </ul>
</li>
  <li>
<a href="#colley-matrix-rankings" id="toc-colley-matrix-rankings" class="nav-link" data-scroll-target="#colley-matrix-rankings"><span class="header-section-number">19.4</span> Colley Matrix Rankings</a>
  <ul class="collapse">
<li><a href="#concept-2" id="toc-concept-2" class="nav-link" data-scroll-target="#concept-2"><span class="header-section-number">19.4.1</span> Concept</a></li>
  </ul>
</li>
  <li>
<a href="#massey-rankings" id="toc-massey-rankings" class="nav-link" data-scroll-target="#massey-rankings"><span class="header-section-number">19.5</span> Massey Rankings</a>
  <ul class="collapse">
<li><a href="#concept-3" id="toc-concept-3" class="nav-link" data-scroll-target="#concept-3"><span class="header-section-number">19.5.1</span> Concept</a></li>
  <li><a href="#example-football-style-scores" id="toc-example-football-style-scores" class="nav-link" data-scroll-target="#example-football-style-scores"><span class="header-section-number">19.5.2</span> Example: Football-Style Scores</a></li>
  </ul>
</li>
  <li>
<a href="#challenges-and-considerations" id="toc-challenges-and-considerations" class="nav-link" data-scroll-target="#challenges-and-considerations"><span class="header-section-number">19.6</span> Challenges and Considerations</a>
  <ul class="collapse">
<li><a href="#unequal-schedules" id="toc-unequal-schedules" class="nav-link" data-scroll-target="#unequal-schedules"><span class="header-section-number">19.6.1</span> Unequal Schedules</a></li>
  <li><a href="#blowout-wins" id="toc-blowout-wins" class="nav-link" data-scroll-target="#blowout-wins"><span class="header-section-number">19.6.2</span> Blowout Wins</a></li>
  <li><a href="#strength-of-opponents" id="toc-strength-of-opponents" class="nav-link" data-scroll-target="#strength-of-opponents"><span class="header-section-number">19.6.3</span> Strength of Opponents</a></li>
  </ul>
</li>
  <li>
<a href="#case-study-ncaa-football-rankings-using-the-colley-and-massey-methods" id="toc-case-study-ncaa-football-rankings-using-the-colley-and-massey-methods" class="nav-link" data-scroll-target="#case-study-ncaa-football-rankings-using-the-colley-and-massey-methods"><span class="header-section-number">19.7</span> Case Study: NCAA Football Rankings Using the Colley and Massey Methods</a>
  <ul class="collapse">
<li><a href="#step-1-load-and-prepare-data" id="toc-step-1-load-and-prepare-data" class="nav-link" data-scroll-target="#step-1-load-and-prepare-data"><span class="header-section-number">19.7.1</span> Step 1: Load and Prepare Data</a></li>
  <li><a href="#step-2-construct-the-match-results" id="toc-step-2-construct-the-match-results" class="nav-link" data-scroll-target="#step-2-construct-the-match-results"><span class="header-section-number">19.7.2</span> Step 2: Construct the Match Results</a></li>
  <li><a href="#step-3-apply-the-colley-and-massey-rankings" id="toc-step-3-apply-the-colley-and-massey-rankings" class="nav-link" data-scroll-target="#step-3-apply-the-colley-and-massey-rankings"><span class="header-section-number">19.7.3</span> Step 3: Apply the Colley and Massey Rankings</a></li>
  <li><a href="#step-4-compare-results" id="toc-step-4-compare-results" class="nav-link" data-scroll-target="#step-4-compare-results"><span class="header-section-number">19.7.4</span> Step 4: Compare Results</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Intro to Rankings</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><blockquote class="blockquote">
<p>“I throw 70 miles an hour. That’s throwing like a girl.” - Mo’ne Davis</p>
</blockquote>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="pics/davis.png" class="img-fluid figure-img" width="300"></p>
<figcaption class="figure-caption">During the summer of 2014, thirteen year old Mon’ne Davis becomes the first girl to picth a complete-game shutout in the Little League World Series in Williamsport.</figcaption></figure>
</div>
<section id="introduction" class="level2" data-number="19.1"><h2 data-number="19.1" class="anchored" data-anchor-id="introduction">
<span class="header-section-number">19.1</span> Introduction</h2>
<p>Ranking teams or individual athletes is a fundamental task in sports analytics. From high school leagues to professional competitions, stakeholders use rankings to determine standings, qualify for playoffs, and even allocate resources. Rankings become particularly important when not every participant faces every other participant—a common occurrence in real-world sports.</p>
<p>In this chapter, we will introduce a series of methods for ranking competitors, starting with basic win percentage calculations and moving toward more sophisticated methods like Massey Rankings. We will use real sports data and implement these methods in R, primarily leveraging the <code>comperank</code> library, along with standard functions from <code>dplyr</code> and <code>tidyverse</code>. Both cases—full round-robins and partial schedules—will be illustrated.</p>
</section><section id="win-percentage-ranking" class="level2" data-number="19.2"><h2 data-number="19.2" class="anchored" data-anchor-id="win-percentage-ranking">
<span class="header-section-number">19.2</span> Win Percentage Ranking</h2>
<section id="concept" class="level3" data-number="19.2.1"><h3 data-number="19.2.1" class="anchored" data-anchor-id="concept">
<span class="header-section-number">19.2.1</span> Concept</h3>
<p>The simplest method for ranking teams or players is the win percentage:</p>
<p><span class="math display">\[
\text{Win Percentage} = \frac{\text{Number of Wins}}{\text{Number of Games Played}}
\]</span></p>
<p>This method assumes that all wins are equally valuable, regardless of opponent strength.</p>
</section><section id="example-full-round-robin-tennis-tournament" class="level3" data-number="19.2.2"><h3 data-number="19.2.2" class="anchored" data-anchor-id="example-full-round-robin-tennis-tournament">
<span class="header-section-number">19.2.2</span> Example: Full Round Robin — Tennis Tournament</h3>
<p>Suppose we have six tennis players who each play every other player exactly once. We simulate the data:</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate match results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">players</span> <span class="op">=</span> <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span></span>
<span><span class="va">matches</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span>player1 <span class="op">=</span> <span class="va">players</span>, player2 <span class="op">=</span> <span class="va">players</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">player1</span> <span class="op">!=</span> <span class="va">player2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>winner <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">0.5</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">player1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">player2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate win percentages</span></span>
<span><span class="va">win_pct</span> <span class="op">=</span> <span class="va">matches</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">player1</span>, <span class="va">player2</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"role"</span>, values_to <span class="op">=</span> <span class="st">"player"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">player</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>    games_played <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    wins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">player</span> <span class="op">==</span> <span class="va">winner</span><span class="op">)</span>,</span>
<span>    win_pct <span class="op">=</span> <span class="va">wins</span> <span class="op">/</span> <span class="va">games_played</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">win_pct</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">win_pct</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  player games_played  wins win_pct
  &lt;fct&gt;         &lt;int&gt; &lt;int&gt;   &lt;dbl&gt;
1 E                10     7     0.7
2 B                10     6     0.6
3 F                10     5     0.5
4 A                10     4     0.4
5 C                10     4     0.4
6 D                10     4     0.4</code></pre>
</div>
</div>
<section id="notes" class="level4"><h4 class="anchored" data-anchor-id="notes">Notes:</h4>
<ul>
<li>Because it’s a full round-robin, every player faces each opponent exactly once.</li>
<li>Win percentage gives a fair but simplistic view.</li>
</ul></section></section></section><section id="points-based-systems" class="level2" data-number="19.3"><h2 data-number="19.3" class="anchored" data-anchor-id="points-based-systems">
<span class="header-section-number">19.3</span> Points-Based Systems</h2>
<section id="concept-1" class="level3" data-number="19.3.1"><h3 data-number="19.3.1" class="anchored" data-anchor-id="concept-1">
<span class="header-section-number">19.3.1</span> Concept</h3>
<p>Some sports (e.g., soccer) use a points system rather than simple win counts. For example:</p>
<ul>
<li>Win = 3 points</li>
<li>Draw = 1 point</li>
<li>Loss = 0 points</li>
</ul>
<p>The total points determine the ranking.</p>
</section><section id="example-soccer-mini-league" class="level3" data-number="19.3.2"><h3 data-number="19.3.2" class="anchored" data-anchor-id="example-soccer-mini-league">
<span class="header-section-number">19.3.2</span> Example: Soccer Mini-League</h3>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Simulate soccer-like match results</span></span>
<span><span class="va">matches</span> <span class="op">=</span> <span class="va">matches</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    outcome <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"win"</span>, <span class="st">"draw"</span>, <span class="st">"loss"</span><span class="op">)</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    points_player1 <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">outcome</span> <span class="op">==</span> <span class="st">"win"</span> <span class="op">&amp;</span> <span class="va">player1</span> <span class="op">==</span> <span class="va">winner</span> <span class="op">~</span> <span class="fl">3</span>,</span>
<span>      <span class="va">outcome</span> <span class="op">==</span> <span class="st">"win"</span> <span class="op">&amp;</span> <span class="va">player2</span> <span class="op">==</span> <span class="va">winner</span> <span class="op">~</span> <span class="fl">0</span>,</span>
<span>      <span class="va">outcome</span> <span class="op">==</span> <span class="st">"draw"</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>      <span class="cn">TRUE</span> <span class="op">~</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span>,</span>
<span>    points_player2 <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">outcome</span> <span class="op">==</span> <span class="st">"win"</span> <span class="op">&amp;</span> <span class="va">player2</span> <span class="op">==</span> <span class="va">winner</span> <span class="op">~</span> <span class="fl">3</span>,</span>
<span>      <span class="va">outcome</span> <span class="op">==</span> <span class="st">"win"</span> <span class="op">&amp;</span> <span class="va">player1</span> <span class="op">==</span> <span class="va">winner</span> <span class="op">~</span> <span class="fl">0</span>,</span>
<span>      <span class="va">outcome</span> <span class="op">==</span> <span class="st">"draw"</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>      <span class="cn">TRUE</span> <span class="op">~</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Now gather points for both players</span></span>
<span><span class="va">points_table</span> <span class="op">=</span> <span class="va">matches</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">player1</span>, <span class="va">player2</span>, <span class="va">points_player1</span>, <span class="va">points_player2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">player1</span>, <span class="va">player2</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"role"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"player"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>points <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">role</span> <span class="op">==</span> <span class="st">"player1"</span>, <span class="va">points_player1</span>, <span class="va">points_player2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">player</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>total_points <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">points</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">total_points</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">points_table</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  player total_points
  &lt;fct&gt;         &lt;dbl&gt;
1 E                18
2 F                14
3 B                13
4 C                13
5 A                 8
6 D                 5</code></pre>
</div>
</div>
<section id="notes-1" class="level4"><h4 class="anchored" data-anchor-id="notes-1">Notes:</h4>
<ul>
<li>Points systems are common for handling tied games.</li>
<li>They incentivize wins over draws.</li>
</ul></section></section></section><section id="colley-matrix-rankings" class="level2" data-number="19.4"><h2 data-number="19.4" class="anchored" data-anchor-id="colley-matrix-rankings">
<span class="header-section-number">19.4</span> Colley Matrix Rankings</h2>
<section id="concept-2" class="level3" data-number="19.4.1"><h3 data-number="19.4.1" class="anchored" data-anchor-id="concept-2">
<span class="header-section-number">19.4.1</span> Concept</h3>
<p>The Colley method is a linear algebra-based system designed for situations where not everyone plays everyone else. It adjusts for strength of schedule.</p>
<p>The Colley Matrix <span class="math inline">\(C\)</span> and vector <span class="math inline">\(b\)</span> are constructed as follows:</p>
<ul>
<li><span class="math inline">\(C_{ii} = 2 + \text{Number of games played}\)</span></li>
<li><span class="math inline">\(C_{ij} = - \text{Number of games between } i \text{ and } j\)</span></li>
<li><span class="math inline">\(b_i = 1 + 0.5(\text{Wins}_i - \text{Losses}_i)\)</span></li>
</ul>
<p>Solving <span class="math inline">\(C \mathbf{r} = \mathbf{b}\)</span> gives the ranking vector <span class="math inline">\(\mathbf{r}\)</span>.</p>
<p>Let’s use the NCAA college football data from the <code>comperes</code> library. It contains game results from ACC teams.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/echasnovski/comperes">comperes</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">ncaa2005</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A longcr object:
# A tibble: 20 × 3
    game player score
   &lt;int&gt; &lt;chr&gt;  &lt;int&gt;
 1     1 Duke       7
 2     1 Miami     52
 3     2 Duke      21
 4     2 UNC       24
 5     3 Duke       7
 6     3 UVA       38
 7     4 Duke       0
 8     4 VT        45
 9     5 Miami     34
10     5 UNC       16
11     6 Miami     25
12     6 UVA       17
13     7 Miami     27
14     7 VT         7
15     8 UNC        7
16     8 UVA        5
17     9 UNC        3
18     9 VT        30
19    10 UVA       14
20    10 VT        52</code></pre>
</div>
</div>
<p>Note the format of the dataset. Each game is formated as long in that each row represents a team/player along with a score.</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/echasnovski/comperank">comperank</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">simple_rankings</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/comperank/man/colley.html">rank_colley</a></span><span class="op">(</span><span class="va">ncaa2005</span>, keep_rating <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">simple_rankings</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  player rating_colley ranking_colley
  &lt;chr&gt;          &lt;dbl&gt;          &lt;dbl&gt;
1 Duke           0.214              5
2 Miami          0.786              1
3 UNC            0.5                3
4 UVA            0.357              4
5 VT             0.643              2</code></pre>
</div>
</div>
<section id="notes-2" class="level4"><h4 class="anchored" data-anchor-id="notes-2">Notes:</h4>
<ul>
<li>Useful for leagues where participants play unequal numbers of games.</li>
<li>Automatically adjusts for the strength of the schedule.</li>
</ul></section></section></section><section id="massey-rankings" class="level2" data-number="19.5"><h2 data-number="19.5" class="anchored" data-anchor-id="massey-rankings">
<span class="header-section-number">19.5</span> Massey Rankings</h2>
<section id="concept-3" class="level3" data-number="19.5.1"><h3 data-number="19.5.1" class="anchored" data-anchor-id="concept-3">
<span class="header-section-number">19.5.1</span> Concept</h3>
<p>The Massey method is another matrix-based method but uses point margins instead of binary win/loss results. It is particularly popular in football analytics.</p>
<p>The Massey Matrix <span class="math inline">\(M\)</span> and vector <span class="math inline">\(p\)</span> are constructed based on:</p>
<ul>
<li>Point differential between teams</li>
<li>Number of games played</li>
</ul>
<p>Solving <span class="math inline">\(M \mathbf{r} = \mathbf{p}\)</span> yields the rankings.</p>
</section><section id="example-football-style-scores" class="level3" data-number="19.5.2"><h3 data-number="19.5.2" class="anchored" data-anchor-id="example-football-style-scores">
<span class="header-section-number">19.5.2</span> Example: Football-Style Scores</h3>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">massey_ranks</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/comperank/man/massey.html">rank_massey</a></span><span class="op">(</span><span class="va">ncaa2005</span>, keep_rating <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">massey_ranks</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  player rating_massey ranking_massey
  &lt;chr&gt;          &lt;dbl&gt;          &lt;dbl&gt;
1 Duke          -24.8               5
2 Miami          18.2               1
3 UNC            -8                 4
4 UVA            -3.40              3
5 VT             18                 2</code></pre>
</div>
</div>
<section id="notes-3" class="level4"><h4 class="anchored" data-anchor-id="notes-3">Notes:</h4>
<ul>
<li>A team’s margin of victory affects their ranking.</li>
<li>Massey Rankings are widely respected for American football, college sports, and other score-based competitions.</li>
</ul></section></section></section><section id="challenges-and-considerations" class="level2" data-number="19.6"><h2 data-number="19.6" class="anchored" data-anchor-id="challenges-and-considerations">
<span class="header-section-number">19.6</span> Challenges and Considerations</h2>
<section id="unequal-schedules" class="level3" data-number="19.6.1"><h3 data-number="19.6.1" class="anchored" data-anchor-id="unequal-schedules">
<span class="header-section-number">19.6.1</span> Unequal Schedules</h3>
<p>When teams or individuals do not face all others equally:</p>
<ul>
<li>Simple win percentages can be misleading.</li>
<li>Points-based systems and matrix methods (Colley, Massey) offer better adjustments.</li>
</ul></section><section id="blowout-wins" class="level3" data-number="19.6.2"><h3 data-number="19.6.2" class="anchored" data-anchor-id="blowout-wins">
<span class="header-section-number">19.6.2</span> Blowout Wins</h3>
<p>Should winning by 40 points matter more than winning by 1 point? Massey rankings incorporate margin of victory; Colley does not.</p>
</section><section id="strength-of-opponents" class="level3" data-number="19.6.3"><h3 data-number="19.6.3" class="anchored" data-anchor-id="strength-of-opponents">
<span class="header-section-number">19.6.3</span> Strength of Opponents</h3>
<p>Advanced systems adjust for opponent strength implicitly (Massey, Colley) or explicitly (Elo ratings, which we will discuss later).</p>
</section></section><section id="case-study-ncaa-football-rankings-using-the-colley-and-massey-methods" class="level2" data-number="19.7"><h2 data-number="19.7" class="anchored" data-anchor-id="case-study-ncaa-football-rankings-using-the-colley-and-massey-methods">
<span class="header-section-number">19.7</span> Case Study: NCAA Football Rankings Using the Colley and Massey Methods</h2>
<p>College football provides an ideal example for ranking teams when the schedule is <strong>incomplete and unbalanced</strong>. Teams play only a subset of other teams, and opponent strength varies greatly.</p>
<p>We will use the <code>cfbdfastR</code> package to obtain actual college football game results.</p>
<section id="step-1-load-and-prepare-data" class="level3" data-number="19.7.1"><h3 data-number="19.7.1" class="anchored" data-anchor-id="step-1-load-and-prepare-data">
<span class="header-section-number">19.7.1</span> Step 1: Load and Prepare Data</h3>
<p>Note that <code>cfdbfastR</code> requires an API key to download the data. Run the code <code><a href="https://cfbfastR.sportsdataverse.org/reference/register_cfbd.html">?register_cfbd</a></code> for details.</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://cfbfastR.sportsdataverse.org/">cfbfastR</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">games</span> <span class="op">=</span> <span class="fu"><a href="https://cfbfastR.sportsdataverse.org/reference/cfbd_game_info.html">cfbd_game_info</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2023</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">home_team</span>, <span class="va">away_team</span>, <span class="va">home_points</span>, <span class="va">away_points</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">games</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  home_team          away_team      home_points away_points
  &lt;chr&gt;              &lt;chr&gt;                &lt;int&gt;       &lt;int&gt;
1 Notre Dame         Navy                    42           3
2 Jacksonville State UTEP                    17          14
3 San Diego State    Ohio                    20          13
4 New Mexico State   Massachusetts           30          41
5 Vanderbilt         Hawai'i                 35          28
6 USC                San José State          56          28</code></pre>
</div>
</div>
</section><section id="step-2-construct-the-match-results" class="level3" data-number="19.7.2"><h3 data-number="19.7.2" class="anchored" data-anchor-id="step-2-construct-the-match-results">
<span class="header-section-number">19.7.2</span> Step 2: Construct the Match Results</h3>
<p>We need to reformat this data to be used by <code>comperank</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create long format for comperank</span></span>
<span><span class="va">matches</span> <span class="op">=</span> <span class="va">games</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>game <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/row_number.html">row_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">home_team</span>, <span class="va">away_team</span>, <span class="va">home_points</span>, <span class="va">away_points</span><span class="op">)</span>,</span>
<span>               names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"location"</span>, <span class="st">".value"</span><span class="op">)</span>,</span>
<span>               names_sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>player <span class="op">=</span> <span class="va">team</span>, score <span class="op">=</span> <span class="va">points</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">game</span>, <span class="va">player</span>, <span class="va">score</span><span class="op">)</span></span>
<span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">matches</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
   game player             score
  &lt;int&gt; &lt;chr&gt;              &lt;int&gt;
1     1 Notre Dame            42
2     1 Navy                   3
3     2 Jacksonville State    17
4     2 UTEP                  14
5     3 San Diego State       20
6     3 Ohio                  13</code></pre>
</div>
</div>
</section><section id="step-3-apply-the-colley-and-massey-rankings" class="level3" data-number="19.7.3"><h3 data-number="19.7.3" class="anchored" data-anchor-id="step-3-apply-the-colley-and-massey-rankings">
<span class="header-section-number">19.7.3</span> Step 3: Apply the Colley and Massey Rankings</h3>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Colley Ranking</span></span>
<span><span class="va">colley_rankings</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/comperank/man/colley.html">rank_colley</a></span><span class="op">(</span><span class="va">matches</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">colley_rankings</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">ranking_colley</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 229 × 2
   player            ranking_colley
   &lt;chr&gt;                      &lt;dbl&gt;
 1 Abilene Christian            207
 2 Air Force                     47
 3 Akron                        228
 4 Alabama                        3
 5 Alabama A&amp;M                  203
 6 Alcorn State                 199
 7 App State                     51
 8 Arizona                       22
 9 Arizona State                111
10 Arkansas                     108
# ℹ 219 more rows</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 229 × 2
   player        ranking_colley
   &lt;chr&gt;                  &lt;dbl&gt;
 1 Washington                 1
 2 Michigan                   2
 3 Alabama                    3
 4 Florida State              4
 5 Texas                      5
 6 Ohio State                 6
 7 Georgia                    7
 8 Oregon                     8
 9 Penn State                 9
10 James Madison             10
# ℹ 219 more rows</code></pre>
</div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Massey Ranking</span></span>
<span><span class="va">massey_rankings</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/comperank/man/massey.html">rank_massey</a></span><span class="op">(</span><span class="va">matches</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">massey_rankings</span><span class="op">)</span><span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">ranking_massey</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 229 × 2
   player            ranking_massey
   &lt;chr&gt;                      &lt;dbl&gt;
 1 Abilene Christian            148
 2 Air Force                     64
 3 Akron                        168
 4 Alabama                       13
 5 Alabama A&amp;M                  212
 6 Alcorn State                 213
 7 App State                     72
 8 Arizona                       16
 9 Arizona State                 82
10 Arkansas                      66
# ℹ 219 more rows</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 229 × 2
   player       ranking_massey
   &lt;chr&gt;                 &lt;dbl&gt;
 1 Oregon                    1
 2 Michigan                  2
 3 Ohio State                3
 4 Penn State                4
 5 Texas                     5
 6 Oklahoma                  6
 7 Georgia                   7
 8 Notre Dame                8
 9 Kansas State              9
10 Washington               10
# ℹ 219 more rows</code></pre>
</div>
</div>
</section><section id="step-4-compare-results" class="level3" data-number="19.7.4"><h3 data-number="19.7.4" class="anchored" data-anchor-id="step-4-compare-results">
<span class="header-section-number">19.7.4</span> Step 4: Compare Results</h3>
<p>Both methods produce a final ranking, but note:</p>
<ul>
<li>
<strong>Colley</strong> only uses win/loss, no margin of victory.</li>
<li>
<strong>Massey</strong> incorporates <strong>score differentials</strong>, so teams with dominant wins can rise in rankings.</li>
</ul>
<section id="observations" class="level4"><h4 class="anchored" data-anchor-id="observations">Observations</h4>
<ul>
<li>A team winning by large margins may rank higher under Massey.</li>
<li>An undefeated team still generally ranks highly under both systems.</li>
</ul></section><section id="limitations" class="level4"><h4 class="anchored" data-anchor-id="limitations">Limitations</h4>
<ul>
<li>Both methods assume independent games. Blowouts may be de-emphasized in the Colley system.</li>
<li>Neither method dynamically adjusts based on changes in team strength over the season (unlike Elo-based models).</li>
</ul>


</section></section></section></main><!-- /main --><script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Show Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Show Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  update_total_correct();
}

</script><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./18_Fitting.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Fitting and Overfitting</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">STA 3311</div>
  </div>
</footer>


</body></html>