<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>STA 3311 Sports Analytics II - 5&nbsp; Logistic Regression with Regularization</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./06_Mixed.html" rel="next">
<link href="./04_Regression.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="webex.css">
</head>
<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./05_Logistic.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Logistic Regression with Regularization</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./"></a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_Intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Intro to Data Manipulation with <code>dplyr</code></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_Stringr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">String, Dates, and Joins</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_Tidymodels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Introduction to Tidymodels</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_Regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Linear Regression with Regularization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_Logistic.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Logistic Regression with Regularization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_Mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Mixed Effects Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_Data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Obtaining Sport Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_Web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Web Scraping with Rvest</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09_ML.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introduction to Machine Learning</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_Random.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Random Forests</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_Spatial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Visualization of Player Tracking Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12_knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">K-Nearest Neighbors</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13_clustering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Clustering</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14_dimension.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Dimensionality Reduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15_SVM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Support Vector Machines</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16_DBSCAN.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">DBSCAN</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17_MLP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Multi-Layer Perceptron</span></span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#introduction-to-logistic-regression" id="toc-introduction-to-logistic-regression" class="nav-link active" data-scroll-target="#introduction-to-logistic-regression"><span class="header-section-number">5.1</span> Introduction to Logistic Regression</a>
  <ul class="collapse">
<li><a href="#interpreting-coefficients" id="toc-interpreting-coefficients" class="nav-link" data-scroll-target="#interpreting-coefficients"><span class="header-section-number">5.1.1</span> Interpreting Coefficients</a></li>
  <li><a href="#the-log-odds-and-coefficients" id="toc-the-log-odds-and-coefficients" class="nav-link" data-scroll-target="#the-log-odds-and-coefficients"><span class="header-section-number">5.1.2</span> The Log-Odds and Coefficients</a></li>
  </ul>
</li>
  <li>
<a href="#cricket-data" id="toc-cricket-data" class="nav-link" data-scroll-target="#cricket-data"><span class="header-section-number">5.2</span> Cricket Data</a>
  <ul class="collapse">
<li><a href="#the-rules-of-cricket" id="toc-the-rules-of-cricket" class="nav-link" data-scroll-target="#the-rules-of-cricket"><span class="header-section-number">5.2.1</span> The Rules of Cricket</a></li>
  <li><a href="#scoring-runs" id="toc-scoring-runs" class="nav-link" data-scroll-target="#scoring-runs"><span class="header-section-number">5.2.2</span> Scoring Runs</a></li>
  <li><a href="#ways-to-get-out" id="toc-ways-to-get-out" class="nav-link" data-scroll-target="#ways-to-get-out"><span class="header-section-number">5.2.3</span> Ways to Get Out</a></li>
  </ul>
</li>
  <li>
<a href="#logistic-fit-of-the-cricket-data" id="toc-logistic-fit-of-the-cricket-data" class="nav-link" data-scroll-target="#logistic-fit-of-the-cricket-data"><span class="header-section-number">5.3</span> Logistic Fit of the Cricket Data</a>
  <ul class="collapse">
<li><a href="#preparing-the-data" id="toc-preparing-the-data" class="nav-link" data-scroll-target="#preparing-the-data"><span class="header-section-number">5.3.1</span> Preparing the Data</a></li>
  <li><a href="#specifying-the-logistic-regression-model" id="toc-specifying-the-logistic-regression-model" class="nav-link" data-scroll-target="#specifying-the-logistic-regression-model"><span class="header-section-number">5.3.2</span> Specifying the Logistic Regression Model</a></li>
  </ul>
</li>
  <li>
<a href="#regularization-in-logistic-regression" id="toc-regularization-in-logistic-regression" class="nav-link" data-scroll-target="#regularization-in-logistic-regression"><span class="header-section-number">5.4</span> Regularization in Logistic Regression</a>
  <ul class="collapse">
<li><a href="#lasso-model-specification" id="toc-lasso-model-specification" class="nav-link" data-scroll-target="#lasso-model-specification"><span class="header-section-number">5.4.1</span> Lasso Model Specification</a></li>
  <li><a href="#ridge-model-specification" id="toc-ridge-model-specification" class="nav-link" data-scroll-target="#ridge-model-specification"><span class="header-section-number">5.4.2</span> Ridge Model Specification</a></li>
  <li><a href="#elastic-net-model-specification" id="toc-elastic-net-model-specification" class="nav-link" data-scroll-target="#elastic-net-model-specification"><span class="header-section-number">5.4.3</span> Elastic Net Model Specification</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Logistic Regression with Regularization</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><blockquote class="blockquote">
<p>“Cricket is basically baseball on valium.” - Robin Williams</p>
</blockquote>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="pics/cricket.png" class="img-fluid figure-img" width="200"></p>
<figcaption class="figure-caption">During the infamous 1932-33 Test series, Australia were in the line of fire as the England fast bowler Harold Larwood employed “bodyline” tactics to disrupt his opponents. One delivery struck Bill Woodfull near the heart, causing him to stagger; another hit Bert Oldfield on the head, leaving him concussed.</figcaption></figure>
</div>
<!-- ::: {.content-visible when-format="pdf"} -->
<!-- ![Frames from an animation of a tesseract, a cube changing over time. This appears as a true animation in the online version. -->
<!-- ](https://placeholder.co/400){#fig-tesseract} -->
<!-- ::: -->
<p>Logistic regression is frequently used to model binary outcomes, such as predicting the likelihood of a player winning a match or scoring above a certain threshold. However, as datasets grow in complexity, it is important to prevent overfitting and ensure the model generalizes well to new data. This is where regularization comes in. In this section, we will introduce logistic regression with regularization.</p>
<section id="introduction-to-logistic-regression" class="level2" data-number="5.1"><h2 data-number="5.1" class="anchored" data-anchor-id="introduction-to-logistic-regression">
<span class="header-section-number">5.1</span> Introduction to Logistic Regression</h2>
<p>Logistic regression is used when the dependent variable is binary. It models the probability of the outcome as a function of the predictors, where the output is transformed through the logistic function, ensuring predictions lie between 0 and 1.</p>
<p>The logistic function is given by:</p>
<p><span class="math display">\[
P(y = 1 | x) = \frac{1}{1 + e^{-(\beta_0 + \beta_1 x_1 + \cdots + \beta_p x_p )}}
\]</span></p>
<p>Where:</p>
<ul>
<li>
<span class="math inline">\(P(y = 1 | x)\)</span> is the probability of the event occurring,</li>
<li>
<span class="math inline">\(\beta_0\)</span> is the intercept,</li>
<li>
<span class="math inline">\(\beta_1,\ldots \beta_p\)</span> are the coefficients for the predictor variables <span class="math inline">\(x_1,\ldots, x_p\)</span>.</li>
</ul>
<section id="interpreting-coefficients" class="level3" data-number="5.1.1"><h3 data-number="5.1.1" class="anchored" data-anchor-id="interpreting-coefficients">
<span class="header-section-number">5.1.1</span> Interpreting Coefficients</h3>
<p>In logistic regression, the coefficients represent the relationship between each predictor variable and the log-odds of the outcome. However, interpreting the coefficients directly can be difficult because they are expressed in terms of the log-odds rather than a probability scale.</p>
<p>To understand the effect of each predictor on the outcome, we often transform the coefficients into odds ratios. The odds ratio for each predictor shows how the odds of the outcome change with a one-unit increase in the predictor variable, holding other variables constant.</p>
</section><section id="the-log-odds-and-coefficients" class="level3" data-number="5.1.2"><h3 data-number="5.1.2" class="anchored" data-anchor-id="the-log-odds-and-coefficients">
<span class="header-section-number">5.1.2</span> The Log-Odds and Coefficients</h3>
<p>The logistic regression model can be written as:</p>
<p><span class="math display">\[
\log\left(\frac{P(y = 1 | x)}{1 - P(y = 1 | x)}\right) = \beta_0 + \beta_1 x_1 + \cdots + \beta_p x_p
\]</span></p>
<p>Where:</p>
<ul>
<li>The left side represents the <strong>log-odds</strong> of the event occurring.</li>
<li>The right side includes the intercept <span class="math inline">\(\beta_0\)</span> and the coefficients <span class="math inline">\(\beta_1,\ldots, \beta_p\)</span> for the predictor variables <span class="math inline">\(x_1,\ldots, x_p\)</span>.</li>
</ul>
<p>Each coefficient <span class="math inline">\(\beta_j\)</span> represents the change in the log-odds of the outcome for a one-unit increase in the predictor <span class="math inline">\(x_j\)</span>. For example, if <span class="math inline">\(\beta_j\)</span> is positive, it means that as <span class="math inline">\(x_j\)</span> increases, the log-odds of the event occurring increases, which in turn increases the probability of the event.</p>
<section id="odds-ratios" class="level4"><h4 class="anchored" data-anchor-id="odds-ratios">Odds Ratios</h4>
<p>To make the coefficients more interpretable, we exponentiate them to obtain <strong>odds ratios</strong>. The odds ratio for a predictor <span class="math inline">\(x_j\)</span> is given by:</p>
<p><span class="math display">\[
\text{OR}_j = e^{\beta_j}
\]</span></p>
<p>The odds ratio tells us how the odds of the outcome change for a one-unit increase in <span class="math inline">\(x_j\)</span>. Specifically:</p>
<ul>
<li>If <span class="math inline">\(\text{OR}_j &gt; 1\)</span>, a one-unit increase in <span class="math inline">\(x_j\)</span> increases the odds of the outcome occurring.</li>
<li>If <span class="math inline">\(\text{OR}_j = 1\)</span>, a one-unit increase in <span class="math inline">\(x_j\)</span> does not change the odds of the outcome occurring.</li>
<li>If <span class="math inline">\(\text{OR}_j &lt; 1\)</span>, a one-unit increase in <span class="math inline">\(x_j\)</span> decreases the odds of the outcome occurring.</li>
</ul></section><section id="example-interpretation" class="level4"><h4 class="anchored" data-anchor-id="example-interpretation">Example Interpretation</h4>
<p>Let’s assume we have a logistic regression model that predicts the likelihood of a cricket player winning a match, and the model includes the predictor variables such as the player’s average score, number of wickets taken, and age. Suppose the coefficient for the player’s average score (<span class="math inline">\(\beta_1\)</span>) is 0.5, and the exponentiated value of <span class="math inline">\(\beta_1\)</span> (i.e., the odds ratio) is 1.65.</p>
<ul>
<li>
<strong>Coefficient Interpretation</strong>: The coefficient of 0.5 means that for every 1-unit increase in the player’s average score, the log-odds of winning the match increase by 0.5. This suggests that higher scores improve the likelihood of winning.</li>
<li>
<strong>Odds Ratio Interpretation</strong>: The odds ratio of 1.65 means that for each 1-unit increase in the player’s average score, the odds of winning increase by 65%. Thus, the higher the player’s average score, the higher the odds of winning.</li>
</ul>
<p>It is important to note that the interpretation of each coefficient is based on the assumption that other variables in the model are held constant. For example, the coefficient for the player’s age might be interpreted as the change in the log-odds of winning for a one-year increase in age, assuming that the player’s score and number of wickets remain constant. scale.</p>
</section></section></section><section id="cricket-data" class="level2" data-number="5.2"><h2 data-number="5.2" class="anchored" data-anchor-id="cricket-data">
<span class="header-section-number">5.2</span> Cricket Data</h2>
<p>Cricket is a widely loved sport, with billions of fans around the world. It ranks second in global popularity, only behind football (soccer), and is particularly cherished in South Asia, Australia, Africa, and Europe.</p>
<section id="the-rules-of-cricket" class="level3" data-number="5.2.1"><h3 data-number="5.2.1" class="anchored" data-anchor-id="the-rules-of-cricket">
<span class="header-section-number">5.2.1</span> The Rules of Cricket</h3>
<p>Cricket is played on a rectangular pitch surrounded by an oval-shaped boundary. At either end of the pitch stands a vertical wicket, consisting of three wooden stumps topped with two small wooden blocks called bails. The game involves two teams, each with 11 players: one team bats while the other bowls.</p>
<section id="the-bowling-team" class="level4"><h4 class="anchored" data-anchor-id="the-bowling-team">The Bowling Team</h4>
<p>The bowler’s job is to deliver a small leather ball toward the batter, aiming to get them out by knocking the bails off the stumps.</p>
</section><section id="the-batting-team" class="level4"><h4 class="anchored" data-anchor-id="the-batting-team">The Batting Team</h4>
<p>The batting team’s objective is to score as many runs as possible without allowing the bowler to dislodge the bails. There are always two batters on the field at a time. After hitting the ball, the batters attempt to swap sides. Each batter continues their turn until they are out, at which point they are replaced by another teammate.</p>
</section></section><section id="scoring-runs" class="level3" data-number="5.2.2"><h3 data-number="5.2.2" class="anchored" data-anchor-id="scoring-runs">
<span class="header-section-number">5.2.2</span> Scoring Runs</h3>
<p>A run is scored when the two batters successfully switch places without getting out. For instance, if a batter hits the ball and manages to reach the opposite wicket and return safely, their team scores two runs. If the batter hits the ball to the boundary of the oval on a bounce, their team scores four runs. A six is awarded if the ball is hit over the boundary on the full (without bouncing).</p>
</section><section id="ways-to-get-out" class="level3" data-number="5.2.3"><h3 data-number="5.2.3" class="anchored" data-anchor-id="ways-to-get-out">
<span class="header-section-number">5.2.3</span> Ways to Get Out</h3>
<p>A batter can be dismissed in several ways, including:</p>
<ul>
<li>
<strong>Caught out:</strong> The batter hits the ball, and it is caught in the air by a fielder.</li>
<li>
<strong>Run out:</strong> A fielder hits the stumps with the ball before the batter can cross the line while attempting to score a run.</li>
<li>
<strong>Bowled out:</strong> The bowler delivers a ball that goes past the batter and knocks the bails off the wicket.</li>
<li>
<strong>Leg before wicket (LBW):</strong> The batter is hit in the legs by a ball that would have hit the stumps.</li>
</ul>
<p>Cricket matches can vary in length, lasting anywhere from a few hours to multiple days, depending on the format. Because batters typically score many runs before getting out, the final scores are often quite high.</p>
<p>The <code>asia_cup</code> data set includes data from each cricket match played in all Asia Cup Tournaments from 1984 (the first one) to 2022. The Asia Cup is a tournament that now takes place every two years, alternating host cities in different countries throughout Asia.</p>
</section></section><section id="logistic-fit-of-the-cricket-data" class="level2" data-number="5.3"><h2 data-number="5.3" class="anchored" data-anchor-id="logistic-fit-of-the-cricket-data">
<span class="header-section-number">5.3</span> Logistic Fit of the Cricket Data</h2>
<p>In this section, we will use the cricket dataset to perform logistic regression and find the odds ratio for predicting whether a cricket player wins a match based on various predictors, such as the player’s average score, number of wickets, and age. We will leverage the <code>tidymodels</code> framework in R to carry out the analysis and interpret the results.</p>
<section id="preparing-the-data" class="level3" data-number="5.3.1"><h3 data-number="5.3.1" class="anchored" data-anchor-id="preparing-the-data">
<span class="header-section-number">5.3.1</span> Preparing the Data</h3>
<p>Let’s begin by loading the cricket dataset and inspecting the first few rows to understand its structure.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org">tidymodels</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">cricket_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"data/cricket_asia_cup.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">cricket_data</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 252
Columns: 13
$ Team          &lt;chr&gt; "Pakistan", "Sri Lanka", "India", "Sri Lanka", "India", …
$ Opponent      &lt;chr&gt; "Sri Lanka", "Pakistan", "Sri Lanka", "India", "Pakistan…
$ Host          &lt;chr&gt; "Sharjah", "Sharjah", "Sharjah", "Sharjah", "Sharjah", "…
$ Year          &lt;int&gt; 1984, 1984, 1984, 1984, 1984, 1984, 1986, 1986, 1986, 19…
$ Toss          &lt;int&gt; 0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 1,…
$ Selection     &lt;int&gt; 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 1,…
$ Run.Scored    &lt;int&gt; 187, 190, 97, 96, 188, 134, 116, 197, 94, 98, 132, 131, …
$ Fours         &lt;int&gt; 9, 11, 9, 7, 13, 5, 10, 14, 0, 4, 0, 0, 15, 11, 5, 10, 5…
$ Sixes         &lt;int&gt; 3, 1, 0, 0, 3, 0, 0, 3, 0, 0, 0, 0, 1, 4, 0, 0, 0, 1, 4,…
$ Extras.Scored &lt;int&gt; 21, 26, 14, 8, 17, 5, 14, 15, 9, 5, 19, 10, 9, 14, 7, 18…
$ Highest.Score &lt;int&gt; 47, 57, 51, 38, 56, 35, 34, 39, 37, 47, 44, 40, 57, 67, …
$ Result        &lt;int&gt; 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0,…
$ Given.Extras  &lt;int&gt; 26, 21, 8, 14, 5, 17, 15, 14, 5, 9, 10, 19, 14, 9, 18, 7…</code></pre>
</div>
</div>
<p>Before fitting a logistic regression model, we need to clean and prepare the data. This may involve:</p>
<ul>
<li>Converting any categorical variables to factors (if necessary),</li>
<li>Handling missing values,</li>
<li>Creating a binary outcome variable (e.g., win or lose),</li>
<li>Splitting the data into training and test sets.</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cricket_data</span> <span class="op">=</span> <span class="va">cricket_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Result <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">Result</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Team</span>, <span class="op">-</span><span class="va">Opponent</span>, <span class="op">-</span><span class="va">Host</span>, <span class="op">-</span><span class="va">Year</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1004</span><span class="op">)</span></span>
<span><span class="va">split</span> <span class="op">=</span> <span class="fu">initial_split</span><span class="op">(</span><span class="va">cricket_data</span>, prop <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="va">train_data</span> <span class="op">=</span> <span class="fu">training</span><span class="op">(</span><span class="va">split</span><span class="op">)</span></span>
<span><span class="va">test_data</span> <span class="op">=</span> <span class="fu">testing</span><span class="op">(</span><span class="va">split</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="specifying-the-logistic-regression-model" class="level3" data-number="5.3.2"><h3 data-number="5.3.2" class="anchored" data-anchor-id="specifying-the-logistic-regression-model">
<span class="header-section-number">5.3.2</span> Specifying the Logistic Regression Model</h3>
<p>Now that the data is prepared, we will specify a logistic regression model using the <code>tidymodels</code> framework.</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">log_reg_spec</span> <span class="op">=</span> <span class="fu">logistic_reg</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_engine</span><span class="op">(</span><span class="st">"glm"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_mode</span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">cricket_recipe</span> <span class="op">=</span> <span class="fu">recipe</span><span class="op">(</span><span class="va">Result</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train_data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">step_normalize</span><span class="op">(</span><span class="fu">all_predictors</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we will combine the model specification and recipe into a workflow and fit the model to the training data.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">log_reg_workflow</span> <span class="op">=</span> <span class="fu">workflow</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_recipe</span><span class="op">(</span><span class="va">cricket_recipe</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_model</span><span class="op">(</span><span class="va">log_reg_spec</span><span class="op">)</span></span>
<span></span>
<span><span class="va">log_reg_fit</span> <span class="op">=</span> <span class="fu">fit</span><span class="op">(</span><span class="va">log_reg_workflow</span>, data <span class="op">=</span> <span class="va">train_data</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Once the model is fitted, we can evaluate its performance and calculate the odds ratios for the predictors. We will use the test data to predict the outcome and assess the model’s accuracy, then exponentiate the coefficients to obtain the odds ratios.</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">predictions</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">log_reg_fit</span>, <span class="va">test_data</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">coef_values</span> <span class="op">=</span> <span class="fu">tidy</span><span class="op">(</span><span class="va">log_reg_fit</span><span class="op">)</span></span>
<span><span class="va">coef_values</span> <span class="op">=</span> <span class="va">coef_values</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>odds_ratio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span><span class="op">)</span>  </span>
<span></span>
<span><span class="va">coef_values</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 6
  term          estimate std.error statistic p.value odds_ratio
  &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;
1 (Intercept)      0.100     0.157     0.637  0.524       1.11 
2 Toss             0.359     0.162     2.21   0.0268      1.43 
3 Selection        0.147     0.170     0.863  0.388       1.16 
4 Run.Scored      -0.348     0.360    -0.966  0.334       0.706
5 Fours            0.447     0.291     1.54   0.124       1.56 
6 Sixes            0.270     0.196     1.38   0.169       1.31 
7 Extras.Scored   -0.139     0.181    -0.766  0.444       0.870
8 Highest.Score    0.678     0.277     2.44   0.0145      1.97 
9 Given.Extras     0.219     0.183     1.20   0.232       1.24 </code></pre>
</div>
</div>
</section></section><section id="regularization-in-logistic-regression" class="level2" data-number="5.4"><h2 data-number="5.4" class="anchored" data-anchor-id="regularization-in-logistic-regression">
<span class="header-section-number">5.4</span> Regularization in Logistic Regression</h2>
<p>In this section, we will apply regularization techniques to improve the performance of the logistic regression model for predicting cricket match outcomes. Regularization helps reduce overfitting, especially when the number of predictors is large or the data is noisy. We will explore three types of regularization as was discussed in the previous section:</p>
<ul>
<li><strong>L1 regularization (Lasso)</strong></li>
<li><strong>L2 regularization (Ridge)</strong></li>
<li>
<strong>Elastic Net</strong> (a combination of L1 and L2)</li>
</ul>
<section id="lasso-model-specification" class="level3" data-number="5.4.1"><h3 data-number="5.4.1" class="anchored" data-anchor-id="lasso-model-specification">
<span class="header-section-number">5.4.1</span> Lasso Model Specification</h3>
<p>In <code>tidymodels</code>, Lasso can be specified by setting the <code>mixture</code> parameter to 1 in the model specification. The <code>penalty</code> controls the strength of the regularization.</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">log_reg_lasso_spec</span> <span class="op">=</span> <span class="fu">logistic_reg</span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">0.01</span>, mixture <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_engine</span><span class="op">(</span><span class="st">"glmnet"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_mode</span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">log_reg_lasso_workflow</span> <span class="op">=</span> <span class="fu">workflow</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_recipe</span><span class="op">(</span><span class="va">cricket_recipe</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_model</span><span class="op">(</span><span class="va">log_reg_lasso_spec</span><span class="op">)</span></span>
<span></span>
<span><span class="va">log_reg_lasso_fit</span> <span class="op">=</span> <span class="fu">fit</span><span class="op">(</span><span class="va">log_reg_lasso_workflow</span>, data <span class="op">=</span> <span class="va">train_data</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tidy</span><span class="op">(</span><span class="va">log_reg_lasso_fit</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 3
  term          estimate penalty
  &lt;chr&gt;            &lt;dbl&gt;   &lt;dbl&gt;
1 (Intercept)     0.0923    0.01
2 Toss            0.283     0.01
3 Selection       0.138     0.01
4 Run.Scored      0         0.01
5 Fours           0.262     0.01
6 Sixes           0.183     0.01
7 Extras.Scored  -0.144     0.01
8 Highest.Score   0.503     0.01
9 Given.Extras    0.131     0.01</code></pre>
</div>
</div>
</section><section id="ridge-model-specification" class="level3" data-number="5.4.2"><h3 data-number="5.4.2" class="anchored" data-anchor-id="ridge-model-specification">
<span class="header-section-number">5.4.2</span> Ridge Model Specification</h3>
<p>To apply Ridge regularization, we set the <code>mixture</code> parameter to 0.</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">log_reg_ridge_spec</span> <span class="op">=</span> <span class="fu">logistic_reg</span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">0.01</span>, mixture <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_engine</span><span class="op">(</span><span class="st">"glmnet"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_mode</span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">log_reg_ridge_workflow</span> <span class="op">=</span> <span class="fu">workflow</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_recipe</span><span class="op">(</span><span class="va">cricket_recipe</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_model</span><span class="op">(</span><span class="va">log_reg_ridge_spec</span><span class="op">)</span></span>
<span></span>
<span><span class="va">log_reg_ridge_fit</span> <span class="op">=</span> <span class="fu">fit</span><span class="op">(</span><span class="va">log_reg_ridge_workflow</span>, data <span class="op">=</span> <span class="va">train_data</span><span class="op">)</span></span>
<span><span class="fu">tidy</span><span class="op">(</span><span class="va">log_reg_ridge_fit</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 3
  term          estimate penalty
  &lt;chr&gt;            &lt;dbl&gt;   &lt;dbl&gt;
1 (Intercept)     0.0942    0.01
2 Toss            0.311     0.01
3 Selection       0.154     0.01
4 Run.Scored     -0.126     0.01
5 Fours           0.346     0.01
6 Sixes           0.236     0.01
7 Extras.Scored  -0.159     0.01
8 Highest.Score   0.532     0.01
9 Given.Extras    0.188     0.01</code></pre>
</div>
</div>
</section><section id="elastic-net-model-specification" class="level3" data-number="5.4.3"><h3 data-number="5.4.3" class="anchored" data-anchor-id="elastic-net-model-specification">
<span class="header-section-number">5.4.3</span> Elastic Net Model Specification</h3>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">log_reg_en_spec</span> <span class="op">=</span> <span class="fu">logistic_reg</span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">0.01</span>, mixture <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_engine</span><span class="op">(</span><span class="st">"glmnet"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_mode</span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">log_reg_en_workflow</span> <span class="op">=</span> <span class="fu">workflow</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_recipe</span><span class="op">(</span><span class="va">cricket_recipe</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">add_model</span><span class="op">(</span><span class="va">log_reg_en_spec</span><span class="op">)</span></span>
<span></span>
<span><span class="va">log_reg_en_fit</span> <span class="op">=</span> <span class="fu">fit</span><span class="op">(</span><span class="va">log_reg_en_workflow</span>, data <span class="op">=</span> <span class="va">train_data</span><span class="op">)</span></span>
<span><span class="fu">tidy</span><span class="op">(</span><span class="va">log_reg_en_fit</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 3
  term          estimate penalty
  &lt;chr&gt;            &lt;dbl&gt;   &lt;dbl&gt;
1 (Intercept)     0.0939    0.01
2 Toss            0.303     0.01
3 Selection       0.150     0.01
4 Run.Scored     -0.0655    0.01
5 Fours           0.305     0.01
6 Sixes           0.211     0.01
7 Extras.Scored  -0.155     0.01
8 Highest.Score   0.530     0.01
9 Given.Extras    0.163     0.01</code></pre>
</div>
</div>
<section id="tuning-the-penalty-and-mixing-hyperparameters" class="level4"><h4 class="anchored" data-anchor-id="tuning-the-penalty-and-mixing-hyperparameters">Tuning the Penalty and Mixing Hyperparameters</h4>
<p>The penalty and mixing hyperparameters control the regularization strength and the balance between Lasso and Ridge. These can be tuned in logistic regression in the same way using cross-validation as discussed in the last section involving linear regression.</p>


</section></section></section></main><!-- /main --><script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Show Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Show Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  update_total_correct();
}

</script><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./04_Regression.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Linear Regression with Regularization</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./06_Mixed.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Mixed Effects Models</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">STA 3311</div>
  </div>
</footer>


</body></html>