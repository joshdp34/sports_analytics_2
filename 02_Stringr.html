<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>STA 3311 Sports Analytics II - 2&nbsp; String, Dates, and Joins</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./03_Tidymodels.html" rel="next">
<link href="./01_Intro.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><link rel="stylesheet" href="webex.css">
</head>
<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./02_Stringr.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">String, Dates, and Joins</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./"></a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_Intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Intro to Data Manipulation with <code>dplyr</code></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_Stringr.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">String, Dates, and Joins</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_Tidymodels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Introduction to Tidymodels</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_Regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Linear Regression with Regularization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_Logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Logistic Regression with Regularization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_Mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Mixed Effects Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_Data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Obtaining Sport Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_Web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Web Scraping with Rvest</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09_ML.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introduction to Machine Learning</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_Random.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Random Forests</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_Spatial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Visualization of Player Tracking Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12_knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">K-Nearest Neighbors</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13_clustering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Clustering</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14_dimension.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Dimensionality Reduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15_SVM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Support Vector Machines</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16_DBSCAN.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">DBSCAN</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17_MLP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Multi-Layer Perceptron</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18_Fitting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Fitting and Overfitting</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19_Rankings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Intro to Rankings</span></span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#string-manipulation" id="toc-string-manipulation" class="nav-link active" data-scroll-target="#string-manipulation"><span class="header-section-number">2.1</span> String Manipulation</a>
  <ul class="collapse">
<li><a href="#common-stringr-functions" id="toc-common-stringr-functions" class="nav-link" data-scroll-target="#common-stringr-functions"><span class="header-section-number">2.1.1</span> Common <code>stringr</code> Functions</a></li>
  <li><a href="#regular-expressions" id="toc-regular-expressions" class="nav-link" data-scroll-target="#regular-expressions"><span class="header-section-number">2.1.2</span> Regular Expressions</a></li>
  </ul>
</li>
  <li>
<a href="#working-with-dates" id="toc-working-with-dates" class="nav-link" data-scroll-target="#working-with-dates"><span class="header-section-number">2.2</span> Working with Dates</a>
  <ul class="collapse">
<li><a href="#common-lubridate-functions" id="toc-common-lubridate-functions" class="nav-link" data-scroll-target="#common-lubridate-functions"><span class="header-section-number">2.2.1</span> Common <code>lubridate</code> Functions</a></li>
  </ul>
</li>
  <li>
<a href="#combining-data-frames" id="toc-combining-data-frames" class="nav-link" data-scroll-target="#combining-data-frames"><span class="header-section-number">2.3</span> Combining Data Frames</a>
  <ul class="collapse">
<li><a href="#types-of-joins" id="toc-types-of-joins" class="nav-link" data-scroll-target="#types-of-joins"><span class="header-section-number">2.3.1</span> Types of Joins</a></li>
  <li><a href="#examples-combining-basketball-data" id="toc-examples-combining-basketball-data" class="nav-link" data-scroll-target="#examples-combining-basketball-data"><span class="header-section-number">2.3.2</span> Examples: Combining Basketball Data</a></li>
  </ul>
</li>
  <li><a href="#concept-quiz" id="toc-concept-quiz" class="nav-link" data-scroll-target="#concept-quiz"><span class="header-section-number">2.4</span> Concept Quiz</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">2</span>&nbsp; <span class="chapter-title">String, Dates, and Joins</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><blockquote class="blockquote">
<p>“Especially in football, it is not a QB’s game… even though the media likes to make it into that - it takes the whole team.” - Joe Montana</p>
</blockquote>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="pics/clark1.jpg" class="img-fluid figure-img" width="300"></p>
<figcaption class="figure-caption">“The Catch”: Dwight Clark catches a pass from Joe Montana resulting in a touchdown to give the 49ers a 28-27 victory over the Dallas Cowboys.</figcaption></figure>
</div>
<!-- ::: {.content-visible when-format="pdf"} -->
<!-- ![Frames from an animation of a tesseract, a cube changing over time. This appears as a true animation in the online version. -->
<!-- ](https://placeholder.co/400){#fig-tesseract} -->
<!-- ::: -->
<p>This section demonstrates how to manage and analyze sports data using string manipulation and date-time operations. We’ll explore tools from the <code>tidyverse</code> in R, using basketball-related datasets like <code>pgfreethrow.csv</code> and other datasets available in R packages.</p>
<section id="string-manipulation" class="level2" data-number="2.1"><h2 data-number="2.1" class="anchored" data-anchor-id="string-manipulation">
<span class="header-section-number">2.1</span> String Manipulation</h2>
<p>String manipulation is essential when handling categorical data or extracting information embedded within text. Using the <code>stringr</code> package from <code>tidyverse</code>, we can efficiently handle text data. This includes cleaning up inconsistent formatting, extracting specific patterns, and transforming data into analyzable formats. For example, when dealing with play results, you might need to distinguish between various outcomes or classify performance metrics based on embedded textual descriptions.</p>
<p>Efficient string manipulation also allows for seamless preprocessing of large datasets, ensuring that raw, unstructured text data can be transformed into usable forms. With tools like regular expressions and the functionality of <code>stringr</code>, you can extract numerical details from text, standardize categories, and even generate new variables based on patterns within your data. These transformations are vital for downstream analyses, including statistical modeling and visualization.</p>
<p>Moreover, combining <code>stringr</code> with other <code>tidyverse</code> functions facilitates a unified workflow. This integration ensures that data wrangling and string processing can occur in a pipeline, reducing redundancy and enhancing reproducibility in sports analytics projects.</p>
<section id="common-stringr-functions" class="level3" data-number="2.1.1"><h3 data-number="2.1.1" class="anchored" data-anchor-id="common-stringr-functions">
<span class="header-section-number">2.1.1</span> Common <code>stringr</code> Functions</h3>
<p>The <code>stringr</code> package provides a comprehensive set of tools for text manipulation. Below are some commonly used functions:</p>
<ul>
<li><p><strong><code><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect()</a></code></strong>: Checks for the presence of a pattern in a string and returns a logical value. This is useful for categorizing or flagging data based on text content.</p></li>
<li><p><strong><code><a href="https://stringr.tidyverse.org/reference/str_extract.html">str_extract()</a></code></strong>: Extracts the first occurrence of a specified pattern. Ideal for pulling out specific details like numbers or substrings embedded in text.</p></li>
<li><p><strong><code><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace()</a></code></strong>: Replaces occurrences of a pattern with a new string. Useful for standardizing text formats or correcting inconsistencies.</p></li>
<li><p><strong><code><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split()</a></code></strong>: Splits strings into components based on a delimiter. This is helpful when parsing structured text like CSV fields embedded in a string.</p></li>
<li><p><strong><code><a href="https://stringr.tidyverse.org/reference/str_length.html">str_length()</a></code></strong>: Returns the number of characters in a string. Useful for quality checks or trimming operations.</p></li>
</ul>
<p>By leveraging these string manipulation methods, analysts can address challenges like inconsistent data entry or embedded patterns within text. These methods not only enhance the quality of the dataset but also open up possibilities for deeper and more nuanced analyses. Ultimately, they enable a smoother transition from raw data to actionable insights, which is especially critical in high-volume datasets.</p>
<div id="exm-02_01" class="theorem example">
<p><span class="theorem-title"><strong>Example 2.1 (Determine Free Throw Outcome) </strong></span>The <code>pgfreethrow.csv</code> dataset contains free throws shot by Paul George during his career through the 2021-2022 season. The data was obtained from <code>https://www.basketball-reference.com</code>. The data contains a column <code>playresult</code>, which logs whether a free throw is a <code>Make</code> or a <code>Miss</code> along with the shot number. We’ll extract and classify this information but first let’s examine the dataset.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"data/pgfreethrow.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 4,170
Columns: 9
$ date       &lt;chr&gt; "10/27/2010", "10/27/2010", "11/9/2010", "11/9/2010", "11/1…
$ vis_team   &lt;chr&gt; "Indiana Pacers", "Indiana Pacers", "Denver Nuggets", "Denv…
$ home_team  &lt;chr&gt; "San Antonio Spurs", "San Antonio Spurs", "Indiana Pacers",…
$ quarter    &lt;chr&gt; "3", "3", "4", "4", "4", "1", "1", "3", "2", "2", "3", "3",…
$ time       &lt;time&gt; 04:26:00, 04:26:00, 06:50:00, 06:50:00, 00:26:00, 00:38:00…
$ court      &lt;chr&gt; "away", "away", "home", "home", "home", "home", "home", "ho…
$ playresult &lt;chr&gt; "makes free throw 1 of 2", "makes free throw 2 of 2", "miss…
$ away_score &lt;dbl&gt; 83, 84, 93, 93, 78, 20, 20, 47, 30, 30, 76, 77, 80, 81, 106…
$ home_score &lt;dbl&gt; 81, 81, 124, 125, 107, 24, 25, 67, 24, 25, 77, 77, 77, 77, …</code></pre>
</div>
</div>
<p>We first want to determine if the free throw attempt was a Make or a Miss. We can use <code>str_detect</code> in combination with <code>if_else</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Determine the outcome of each free throw</span></span>
<span><span class="va">dat</span> <span class="op">=</span> <span class="va">dat</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    outcome <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">playresult</span>, <span class="st">"make"</span><span class="op">)</span>, <span class="st">"make"</span>, <span class="st">"miss"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 4,170
Columns: 10
$ date       &lt;chr&gt; "10/27/2010", "10/27/2010", "11/9/2010", "11/9/2010", "11/1…
$ vis_team   &lt;chr&gt; "Indiana Pacers", "Indiana Pacers", "Denver Nuggets", "Denv…
$ home_team  &lt;chr&gt; "San Antonio Spurs", "San Antonio Spurs", "Indiana Pacers",…
$ quarter    &lt;chr&gt; "3", "3", "4", "4", "4", "1", "1", "3", "2", "2", "3", "3",…
$ time       &lt;time&gt; 04:26:00, 04:26:00, 06:50:00, 06:50:00, 00:26:00, 00:38:00…
$ court      &lt;chr&gt; "away", "away", "home", "home", "home", "home", "home", "ho…
$ playresult &lt;chr&gt; "makes free throw 1 of 2", "makes free throw 2 of 2", "miss…
$ away_score &lt;dbl&gt; 83, 84, 93, 93, 78, 20, 20, 47, 30, 30, 76, 77, 80, 81, 106…
$ home_score &lt;dbl&gt; 81, 81, 124, 125, 107, 24, 25, 67, 24, 25, 77, 77, 77, 77, …
$ outcome    &lt;chr&gt; "make", "make", "miss", "make", "make", "make", "make", "ma…</code></pre>
</div>
</div>
</div>
</section><section id="regular-expressions" class="level3" data-number="2.1.2"><h3 data-number="2.1.2" class="anchored" data-anchor-id="regular-expressions">
<span class="header-section-number">2.1.2</span> Regular Expressions</h3>
<p>Regular expressions (regex) are a powerful tool for identifying patterns in text. They allow you to define complex search patterns using a concise syntax, making them ideal for string extraction, validation, and manipulation. In R, the <code>stringr</code> package seamlessly integrates regex functionality, enabling analysts to perform advanced text operations efficiently.</p>
<p>For example, a regex pattern like <code>"\\d of \\d"</code> can identify phrases like “1 of 2” in a dataset, extracting structured information embedded within text fields. Regex is particularly useful for parsing datasets with varying formats or extracting subsets of data based on specific conditions. Combined with <code>stringr</code> functions like <code>str_detect</code>, <code>str_extract</code>, and <code>str_replace</code>, regex becomes an essential part of your data preprocessing toolkit.</p>
<p>While regex might seem daunting at first, breaking patterns into smaller components and testing them incrementally can make them more approachable. Mastery of regex not only improves data cleaning workflows but also enhances the accuracy and depth of data extraction, empowering analysts to unlock insights that would otherwise remain hidden.</p>
<section id="common-regex-patterns" class="level4"><h4 class="anchored" data-anchor-id="common-regex-patterns">Common regex patterns</h4>
<p>Here are some commonly used regex patterns and their functions:</p>
<ul>
<li><p><strong><code>^</code></strong>: Matches the start of a string. Useful for identifying strings that begin with a specific pattern. Example: <code>^Make</code> matches any string starting with “Make”.</p></li>
<li><p><strong><code>$</code></strong>: Matches the end of a string. Useful for ensuring a string concludes with a particular sequence. Example: <code>2$</code> matches strings ending in “2”.</p></li>
<li><p><strong><code>.</code></strong>: Matches any single character except a newline. This is helpful for flexible matching. Example: <code>M.ke</code> matches “Make”, “Mike”, or “Moke”.</p></li>
<li><p><strong><code>\d</code></strong>: Matches any digit. Useful for extracting numeric values. Example: <code>\d of \d</code> matches strings like “1 of 2”.</p></li>
<li><p><strong><code>[]</code></strong>: Matches any character inside the brackets. Use this to define a character set. Example: <code>[Mm]ake</code> matches “Make” and “make”.</p></li>
<li><p><strong><code>+</code></strong>: Matches one or more occurrences of the preceding element. Example: <code>\d+</code> matches any sequence of digits, such as “123” or “7”.</p></li>
</ul>
<p>By combining these patterns, you can create robust expressions for almost any text-processing need. Regular expressions are incredibly versatile and, when used effectively, can transform the way you handle text data.</p>
</section><section id="more-examples" class="level4"><h4 class="anchored" data-anchor-id="more-examples">More examples</h4>
<p>Here are additional examples of regex applications using some simple toy datasets.</p>
<ol type="1">
<li>
<p><strong>Extract Player Names</strong></p>
<p>Suppose we have player names in the format “Last, First”. Using regex, we can separate them into first and last names.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">players</span> <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"James, LeBron"</span>, <span class="st">"Curry, Stephen"</span>, <span class="st">"Durant, Kevin"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">players</span> <span class="op">=</span> <span class="va">players</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    first_name <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">name</span>, <span class="st">"(?&lt;=, ).*"</span><span class="op">)</span>,</span>
<span>    last_name <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">name</span>, <span class="st">"^.*(?=,)"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">players</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  name           first_name last_name
  &lt;chr&gt;          &lt;chr&gt;      &lt;chr&gt;    
1 James, LeBron  LeBron     James    
2 Curry, Stephen Stephen    Curry    
3 Durant, Kevin  Kevin      Durant   </code></pre>
</div>
</div>
</li>
<li>
<p><strong>Identify Scoring Plays</strong></p>
<p>In game logs, scoring plays may include text like “scores 3 points” or “makes a free throw”. Use regex to flag all scoring events.</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plays</span> <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>event <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LeBron scores 3 points"</span>, <span class="st">"Curry makes a free throw"</span>, <span class="st">"Durant misses shot"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plays</span> <span class="op">=</span> <span class="va">plays</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>scoring <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">event</span>, <span class="st">"scores|makes"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plays</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  event                    scoring
  &lt;chr&gt;                    &lt;lgl&gt;  
1 LeBron scores 3 points   TRUE   
2 Curry makes a free throw TRUE   
3 Durant misses shot       FALSE  </code></pre>
</div>
</div>
</li>
<li>
<p><strong>Parse Complex IDs</strong></p>
<p>For datasets with IDs like “P123-456-789”, extract the numeric components for further analysis.</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ids</span> <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>player_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"P123-456-789"</span>, <span class="st">"P987-654-321"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ids</span> <span class="op">=</span> <span class="va">ids</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    part1 <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">player_id</span>, <span class="st">"(?&lt;=P)\\d+"</span><span class="op">)</span>,</span>
<span>    part2 <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">player_id</span>, <span class="st">"(?&lt;=-)\\d+(?=-)"</span><span class="op">)</span>,</span>
<span>    part3 <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">player_id</span>, <span class="st">"\\d+$"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">ids</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  player_id    part1 part2 part3
  &lt;chr&gt;        &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
1 P123-456-789 123   456   789  
2 P987-654-321 987   654   321  </code></pre>
</div>
</div>
</li>
</ol></section></section></section><section id="working-with-dates" class="level2" data-number="2.2"><h2 data-number="2.2" class="anchored" data-anchor-id="working-with-dates">
<span class="header-section-number">2.2</span> Working with Dates</h2>
<p>Analyzing performance trends often involves working with date-time variables. Dates might be stored as text, requiring conversion to a proper date format.</p>
<section id="common-lubridate-functions" class="level3" data-number="2.2.1"><h3 data-number="2.2.1" class="anchored" data-anchor-id="common-lubridate-functions">
<span class="header-section-number">2.2.1</span> Common <code>lubridate</code> Functions</h3>
<p>The <code>lubridate</code> package is an essential tool in R for working with date and time data. Below are some of the most commonly used functions and their applications:</p>
<ul>
<li>
<p><strong><code><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd()</a></code> / <code><a href="https://lubridate.tidyverse.org/reference/ymd.html">mdy()</a></code> / <code><a href="https://lubridate.tidyverse.org/reference/ymd.html">dmy()</a></code></strong>: These functions parse text strings into date objects, assuming the formats “Year-Month-Day”, “Month-Day-Year”, or “Day-Month-Year”, respectively.</p>
<p>Example:</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">"2023-12-29"</span><span class="op">)</span>  <span class="co"># Returns a date object: "2023-12-29"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2023-12-29"</code></pre>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">mdy</a></span><span class="op">(</span><span class="st">"12-29-2023"</span><span class="op">)</span>  <span class="co"># Returns a date object: "2023-12-29"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2023-12-29"</code></pre>
</div>
</div>
</li>
<li>
<p><strong><code><a href="https://lubridate.tidyverse.org/reference/year.html">year()</a></code>, <code><a href="https://lubridate.tidyverse.org/reference/month.html">month()</a></code>, <code><a href="https://lubridate.tidyverse.org/reference/day.html">day()</a></code></strong>: Extract specific components (year, month, or day) from a date object. The <code><a href="https://lubridate.tidyverse.org/reference/month.html">month()</a></code> function can also return month names if <code>label = TRUE</code> is used.</p>
<p>Example:</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">date</span> <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">"2023-12-29"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html">year</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>   </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2023</code></pre>
</div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html">month</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12</code></pre>
</div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html">day</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 29</code></pre>
</div>
</div>
</li>
<li>
<p><strong><code><a href="https://lubridate.tidyverse.org/reference/hour.html">hour()</a></code>, <code><a href="https://lubridate.tidyverse.org/reference/minute.html">minute()</a></code>, <code><a href="https://lubridate.tidyverse.org/reference/second.html">second()</a></code></strong>: Extract time components from a datetime object.</p>
<p>Example:</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">datetime</span> <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html">ymd_hms</a></span><span class="op">(</span><span class="st">"2023-12-29 15:45:30"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/hour.html">hour</a></span><span class="op">(</span><span class="va">datetime</span><span class="op">)</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15</code></pre>
</div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/minute.html">minute</a></span><span class="op">(</span><span class="va">datetime</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 45</code></pre>
</div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/second.html">second</a></span><span class="op">(</span><span class="va">datetime</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 30</code></pre>
</div>
</div>
</li>
<li>
<p><strong><code><a href="https://lubridate.tidyverse.org/reference/now.html">today()</a></code> and <code><a href="https://lubridate.tidyverse.org/reference/now.html">now()</a></code></strong>: Retrieve the current date or datetime in the system’s timezone.</p>
<p>Example:</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/now.html">today</a></span><span class="op">(</span><span class="op">)</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2025-04-12"</code></pre>
</div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/now.html">now</a></span><span class="op">(</span><span class="op">)</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2025-04-12 21:11:28 CDT"</code></pre>
</div>
</div>
</li>
<li>
<p><strong><code><a href="https://lubridate.tidyverse.org/reference/round_date.html">floor_date()</a></code>, <code><a href="https://lubridate.tidyverse.org/reference/round_date.html">ceiling_date()</a></code>, <code><a href="https://lubridate.tidyverse.org/reference/round_date.html">round_date()</a></code></strong>: Round dates to the nearest unit such as day, month, or year.</p>
<p>Example:</p>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">date</span> <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">"2023-12-29"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/round_date.html">floor_date</a></span><span class="op">(</span><span class="va">date</span>, <span class="st">"month"</span><span class="op">)</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2023-12-01"</code></pre>
</div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/round_date.html">ceiling_date</a></span><span class="op">(</span><span class="va">date</span>, <span class="st">"month"</span><span class="op">)</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2024-01-01"</code></pre>
</div>
</div>
</li>
<li>
<p><strong><code><a href="https://lubridate.tidyverse.org/reference/interval.html">interval()</a></code> and <code><a href="https://lubridate.tidyverse.org/reference/duration.html">duration()</a></code></strong>: Create and manipulate intervals or durations. These functions are useful for calculating time differences.</p>
<p>Example:</p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">start</span> <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">"2023-01-01"</span><span class="op">)</span></span>
<span><span class="va">end</span> <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">"2023-12-31"</span><span class="op">)</span></span>
<span><span class="va">int</span> <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/interval.html">interval</a></span><span class="op">(</span><span class="va">start</span>, <span class="va">end</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/interval.html">int_shift</a></span><span class="op">(</span><span class="va">int</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/duration.html">duration</a></span><span class="op">(</span>days <span class="op">=</span> <span class="fl">14</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2023-01-15 UTC--2024-01-14 UTC</code></pre>
</div>
</div>
</li>
</ul>
<p>By understanding and using these functions, you can seamlessly handle date-time data in sports analytics, enabling you to analyze performance trends, calculate durations, and identify patterns over time.</p>
<div id="exm-02_03" class="theorem example">
<p><span class="theorem-title"><strong>Example 2.2 (Converting to dates) </strong></span>&nbsp;</p>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert game_date to Date type</span></span>
<span><span class="va">dat</span> <span class="op">=</span> <span class="va">dat</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>date <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">mdy</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the structure of the dataset</span></span>
<span><span class="va">dat</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 4,170
Columns: 10
$ date       &lt;date&gt; 2010-10-27, 2010-10-27, 2010-11-09, 2010-11-09, 2010-11-18…
$ vis_team   &lt;chr&gt; "Indiana Pacers", "Indiana Pacers", "Denver Nuggets", "Denv…
$ home_team  &lt;chr&gt; "San Antonio Spurs", "San Antonio Spurs", "Indiana Pacers",…
$ quarter    &lt;chr&gt; "3", "3", "4", "4", "4", "1", "1", "3", "2", "2", "3", "3",…
$ time       &lt;time&gt; 04:26:00, 04:26:00, 06:50:00, 06:50:00, 00:26:00, 00:38:00…
$ court      &lt;chr&gt; "away", "away", "home", "home", "home", "home", "home", "ho…
$ playresult &lt;chr&gt; "makes free throw 1 of 2", "makes free throw 2 of 2", "miss…
$ away_score &lt;dbl&gt; 83, 84, 93, 93, 78, 20, 20, 47, 30, 30, 76, 77, 80, 81, 106…
$ home_score &lt;dbl&gt; 81, 81, 124, 125, 107, 24, 25, 67, 24, 25, 77, 77, 77, 77, …
$ outcome    &lt;chr&gt; "make", "make", "miss", "make", "make", "make", "make", "ma…</code></pre>
</div>
</div>
</div>
<p>Suppose we want to determine if Paul George has different free throw percentages for different months of the year. Let’s extract the month component of the date so that we can summarize.</p>
<div id="exm-02_04" class="theorem example">
<p><span class="theorem-title"><strong>Example 2.3 (Extract Year and Month) </strong></span>&nbsp;</p>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Extract year and month</span></span>
<span><span class="va">dat</span> <span class="op">=</span> <span class="va">dat</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    year <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html">year</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>,</span>
<span>    month <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html">month</a></span><span class="op">(</span><span class="va">date</span>, label <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Summarize free throw percentages by month</span></span>
<span><span class="va">dat_summary</span> <span class="op">=</span> <span class="va">dat</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">month</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>    total_shots <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    makes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">outcome</span> <span class="op">==</span> <span class="st">"make"</span><span class="op">)</span>,</span>
<span>    free_throw_percentage <span class="op">=</span> <span class="va">makes</span> <span class="op">/</span> <span class="va">total_shots</span> <span class="op">*</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Display summary</span></span>
<span><span class="va">dat_summary</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 4
   month total_shots makes free_throw_percentage
   &lt;ord&gt;       &lt;int&gt; &lt;int&gt;                 &lt;dbl&gt;
 1 Jan           642   545                  84.9
 2 Feb           513   434                  84.6
 3 Mar           695   583                  83.9
 4 Apr           598   507                  84.8
 5 May           257   197                  76.7
 6 Jun           143   117                  81.8
 7 Jul             4     2                  50  
 8 Aug            48    44                  91.7
 9 Sep            33    29                  87.9
10 Oct           127   105                  82.7
11 Nov           479   411                  85.8
12 Dec           631   544                  86.2</code></pre>
</div>
</div>
<p>By exploring free throw performance by month, we can identify seasonal trends or patterns in player accuracy. Understanding such patterns can be invaluable for game preparation and performance analysis.</p>
</div>
</section></section><section id="combining-data-frames" class="level2" data-number="2.3"><h2 data-number="2.3" class="anchored" data-anchor-id="combining-data-frames">
<span class="header-section-number">2.3</span> Combining Data Frames</h2>
<p>In sports analytics, combining datasets is often necessary to enrich analyses by merging relevant data sources. The <code>dplyr</code> package in R provides several join functions to combine data frames based on common columns (keys). These include:</p>
<section id="types-of-joins" class="level3" data-number="2.3.1"><h3 data-number="2.3.1" class="anchored" data-anchor-id="types-of-joins">
<span class="header-section-number">2.3.1</span> Types of Joins</h3>
<ul>
<li>
<strong><code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join()</a></code></strong>: Returns rows with matching keys in both data frames.</li>
<li>
<strong><code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join()</a></code></strong>: Returns all rows from the first data frame and matching rows from the second data frame.</li>
<li>
<strong><code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">right_join()</a></code></strong>: Returns all rows from the second data frame and matching rows from the first data frame.</li>
<li>
<strong><code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">full_join()</a></code></strong>: Returns all rows from both data frames, with <code>NA</code> for unmatched rows.</li>
<li>
<strong><code><a href="https://dplyr.tidyverse.org/reference/filter-joins.html">semi_join()</a></code></strong>: Filters rows from the first data frame that have matches in the second data frame but doesn’t include columns from the second data frame.</li>
<li>
<strong><code><a href="https://dplyr.tidyverse.org/reference/filter-joins.html">anti_join()</a></code></strong>: Filters rows from the first data frame that do not have matches in the second data frame.</li>
</ul></section><section id="examples-combining-basketball-data" class="level3" data-number="2.3.2"><h3 data-number="2.3.2" class="anchored" data-anchor-id="examples-combining-basketball-data">
<span class="header-section-number">2.3.2</span> Examples: Combining Basketball Data</h3>
<p>Let’s illustrate these joins using two basketball-related datasets:</p>
<ol type="1">
<li>
<code>players</code> contains player names and their team IDs.</li>
<li>
<code>teams</code> contains team IDs and their names.</li>
</ol>
<section id="the-data" class="level4"><h4 class="anchored" data-anchor-id="the-data">The Data</h4>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">players</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  player_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,</span>
<span>  player_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LeBron James"</span>, <span class="st">"Stephen Curry"</span>, <span class="st">"Kevin Durant"</span>, <span class="st">"Chris Paul"</span><span class="op">)</span>,</span>
<span>  team_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">teams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  team_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  team_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Lakers"</span>, <span class="st">"Warriors"</span>, <span class="st">"Nets"</span>, <span class="st">"Knicks"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="inner-join" class="level4"><h4 class="anchored" data-anchor-id="inner-join">Inner Join</h4>
<p>Keeps only players with matching team IDs in the <code>teams</code> table.</p>
<div class="cell">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">players</span>, <span class="va">teams</span>, by <span class="op">=</span> <span class="st">"team_id"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  player_id player_name   team_id team_name
      &lt;int&gt; &lt;chr&gt;           &lt;dbl&gt; &lt;chr&gt;    
1         1 LeBron James        1 Lakers   
2         2 Stephen Curry       2 Warriors 
3         3 Kevin Durant        3 Nets     </code></pre>
</div>
</div>
</section><section id="left-join" class="level4"><h4 class="anchored" data-anchor-id="left-join">Left Join</h4>
<p>Keeps all players, adding team names where possible.</p>
<div class="cell">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">players</span>, <span class="va">teams</span>, by <span class="op">=</span> <span class="st">"team_id"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
  player_id player_name   team_id team_name
      &lt;int&gt; &lt;chr&gt;           &lt;dbl&gt; &lt;chr&gt;    
1         1 LeBron James        1 Lakers   
2         2 Stephen Curry       2 Warriors 
3         3 Kevin Durant        3 Nets     
4         4 Chris Paul          4 &lt;NA&gt;     </code></pre>
</div>
</div>
</section><section id="full-join" class="level4"><h4 class="anchored" data-anchor-id="full-join">Full Join</h4>
<p>Combines all rows from both datasets.</p>
<div class="cell">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">full_join</a></span><span class="op">(</span><span class="va">players</span>, <span class="va">teams</span>, by <span class="op">=</span> <span class="st">"team_id"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
  player_id player_name   team_id team_name
      &lt;int&gt; &lt;chr&gt;           &lt;dbl&gt; &lt;chr&gt;    
1         1 LeBron James        1 Lakers   
2         2 Stephen Curry       2 Warriors 
3         3 Kevin Durant        3 Nets     
4         4 Chris Paul          4 &lt;NA&gt;     
5        NA &lt;NA&gt;                5 Knicks   </code></pre>
</div>
</div>
</section><section id="semi-join" class="level4"><h4 class="anchored" data-anchor-id="semi-join">Semi Join</h4>
<p>Filters <code>players</code> to include only those on teams listed in <code>teams</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter-joins.html">semi_join</a></span><span class="op">(</span><span class="va">players</span>, <span class="va">teams</span>, by <span class="op">=</span> <span class="st">"team_id"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  player_id player_name   team_id
      &lt;int&gt; &lt;chr&gt;           &lt;dbl&gt;
1         1 LeBron James        1
2         2 Stephen Curry       2
3         3 Kevin Durant        3</code></pre>
</div>
</div>
</section><section id="anti-join" class="level4"><h4 class="anchored" data-anchor-id="anti-join">Anti Join</h4>
<p>Filters <code>players</code> to include only those not matched in <code>teams</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter-joins.html">anti_join</a></span><span class="op">(</span><span class="va">players</span>, <span class="va">teams</span>, by <span class="op">=</span> <span class="st">"team_id"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  player_id player_name team_id
      &lt;int&gt; &lt;chr&gt;         &lt;dbl&gt;
1         4 Chris Paul        4</code></pre>
</div>
</div>
<p>Understanding and using these joins effectively is critical for analyzing sports data where relationships between entities, such as players and teams, are vital.</p>
</section></section></section><section id="concept-quiz" class="level2" data-number="2.4"><h2 data-number="2.4" class="anchored" data-anchor-id="concept-quiz">
<span class="header-section-number">2.4</span> Concept Quiz</h2>
<ol type="1">
<li>What function in <code>stringr</code> is used to detect the presence of a pattern in a string?
<div id="radio_QLGLAIXDMY" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_QLGLAIXDMY" value=""><span><code><a href="https://stringr.tidyverse.org/reference/str_extract.html">str_extract()</a></code></span></label><label><input type="radio" autocomplete="off" name="radio_QLGLAIXDMY" value=""><span><code><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace()</a></code></span></label><label><input type="radio" autocomplete="off" name="radio_QLGLAIXDMY" value=""><span><code><a href="https://stringr.tidyverse.org/reference/str_length.html">str_length()</a></code></span></label><label><input type="radio" autocomplete="off" name="radio_QLGLAIXDMY" value="answer"><span><code><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect()</a></code></span></label>
</div>
</li>
<li>What is the purpose of the <code><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace()</a></code> function?
<div id="radio_IRASAYKNVE" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_IRASAYKNVE" value=""><span>Extract substrings from text</span></label><label><input type="radio" autocomplete="off" name="radio_IRASAYKNVE" value="answer"><span>Replace occurrences of a pattern in a string</span></label><label><input type="radio" autocomplete="off" name="radio_IRASAYKNVE" value=""><span>Count characters in a string</span></label><label><input type="radio" autocomplete="off" name="radio_IRASAYKNVE" value=""><span>Check if a pattern exists in a string</span></label>
</div>
</li>
<li>What regex pattern matches one or more digits?
<div id="radio_YZCYDQGYZG" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_YZCYDQGYZG" value=""><span><code>[a-zA-Z]</code></span></label><label><input type="radio" autocomplete="off" name="radio_YZCYDQGYZG" value=""><span><code>\d*</code></span></label><label><input type="radio" autocomplete="off" name="radio_YZCYDQGYZG" value="answer"><span><code>\d+</code></span></label><label><input type="radio" autocomplete="off" name="radio_YZCYDQGYZG" value=""><span><code>[0-9]</code></span></label>
</div>
</li>
<li>Which <code>lubridate</code> function parses dates in the format “Year-Month-Day”?
<div id="radio_URUMPFERGN" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_URUMPFERGN" value=""><span><code><a href="https://lubridate.tidyverse.org/reference/ymd.html">mdy()</a></code></span></label><label><input type="radio" autocomplete="off" name="radio_URUMPFERGN" value=""><span><code><a href="https://lubridate.tidyverse.org/reference/ymd.html">dmy()</a></code></span></label><label><input type="radio" autocomplete="off" name="radio_URUMPFERGN" value=""><span><code><a href="https://readr.tidyverse.org/reference/parse_datetime.html">parse_date()</a></code></span></label><label><input type="radio" autocomplete="off" name="radio_URUMPFERGN" value="answer"><span><code><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd()</a></code></span></label>
</div>
</li>
<li>What does the <code><a href="https://lubridate.tidyverse.org/reference/interval.html">interval()</a></code> function in <code>lubridate</code> do?
<div id="radio_AZMZXKJZUG" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_AZMZXKJZUG" value=""><span>Calculate the day of the week</span></label><label><input type="radio" autocomplete="off" name="radio_AZMZXKJZUG" value=""><span>Parse a date-time string</span></label><label><input type="radio" autocomplete="off" name="radio_AZMZXKJZUG" value="answer"><span>Create a range between two dates</span></label><label><input type="radio" autocomplete="off" name="radio_AZMZXKJZUG" value=""><span>Extract time components</span></label>
</div>
</li>
<li>Which join in <code>dplyr</code> returns rows that have matches in both data frames?
<div id="radio_DDZKJZWMRD" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_DDZKJZWMRD" value="answer"><span><code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join()</a></code></span></label><label><input type="radio" autocomplete="off" name="radio_DDZKJZWMRD" value=""><span><code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">full_join()</a></code></span></label><label><input type="radio" autocomplete="off" name="radio_DDZKJZWMRD" value=""><span><code><a href="https://dplyr.tidyverse.org/reference/filter-joins.html">anti_join()</a></code></span></label><label><input type="radio" autocomplete="off" name="radio_DDZKJZWMRD" value=""><span><code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join()</a></code></span></label>
</div>
</li>
<li>Which join ensures all rows from both data frames are included?
<div id="radio_SHAMNWLLKH" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_SHAMNWLLKH" value=""><span><code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join()</a></code></span></label><label><input type="radio" autocomplete="off" name="radio_SHAMNWLLKH" value="answer"><span><code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">full_join()</a></code></span></label><label><input type="radio" autocomplete="off" name="radio_SHAMNWLLKH" value=""><span><code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join()</a></code></span></label><label><input type="radio" autocomplete="off" name="radio_SHAMNWLLKH" value=""><span><code><a href="https://dplyr.tidyverse.org/reference/filter-joins.html">anti_join()</a></code></span></label>
</div>
</li>
<li>If <code>players</code> has 6 rows and <code>teams</code> has 3 matching rows, how many rows will the result of <code>inner_join(players, teams, by = "team_id")</code> contain?
<div id="radio_HEKLNQWYYM" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_HEKLNQWYYM" value=""><span>7</span></label><label><input type="radio" autocomplete="off" name="radio_HEKLNQWYYM" value=""><span>0</span></label><label><input type="radio" autocomplete="off" name="radio_HEKLNQWYYM" value=""><span>4</span></label><label><input type="radio" autocomplete="off" name="radio_HEKLNQWYYM" value="answer"><span>3</span></label>
</div>
</li>
</ol>


</section></main><!-- /main --><script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Show Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Show Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  update_total_correct();
}

</script><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./01_Intro.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Intro to Data Manipulation with <code>dplyr</code></span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./03_Tidymodels.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Introduction to Tidymodels</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">STA 3311</div>
  </div>
</footer>


</body></html>