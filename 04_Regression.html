<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>STA 3311 Sports Analytics II - 4&nbsp; Linear Regression with Regularization</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./05_Logistic.html" rel="next">
<link href="./03_Tidymodels.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="webex.css">
</head>
<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./04_Regression.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Linear Regression with Regularization</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./"></a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_Intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Intro to Data Manipulation with <code>dplyr</code></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_Stringr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">String, Dates, and Joins</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_Tidymodels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Introduction to Tidymodels</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_Regression.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Linear Regression with Regularization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_Logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Logistic Regression with Regularization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_Mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Mixed Effects Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_Data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Obtaining Sport Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_Web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Web Scraping with Rvest</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09_ML.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introduction to Machine Learning</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_Random.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Random Forests</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_Spatial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Visualization of Player Tracking Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12_knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">K-Nearest Neighbors</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13_clustering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Clustering</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14_dimension.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Dimensionality Reduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15_SVM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Support Vector Machines</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16_DBSCAN.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">DBSCAN</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17_MLP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Multi-Layer Perceptron</span></span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#introduction-to-regularization" id="toc-introduction-to-regularization" class="nav-link active" data-scroll-target="#introduction-to-regularization"><span class="header-section-number">4.1</span> Introduction to Regularization</a>
  <ul class="collapse">
<li><a href="#elastic-net-regularization" id="toc-elastic-net-regularization" class="nav-link" data-scroll-target="#elastic-net-regularization"><span class="header-section-number">4.1.1</span> Elastic Net Regularization</a></li>
  </ul>
</li>
  <li><a href="#the-pga2022.csv-dataset" id="toc-the-pga2022.csv-dataset" class="nav-link" data-scroll-target="#the-pga2022.csv-dataset"><span class="header-section-number">4.2</span> The <code>PGA2022.csv</code> dataset</a></li>
  <li><a href="#loading-and-preparing-the-data" id="toc-loading-and-preparing-the-data" class="nav-link" data-scroll-target="#loading-and-preparing-the-data"><span class="header-section-number">4.3</span> Loading and Preparing the Data</a></li>
  <li><a href="#data-preprocessing" id="toc-data-preprocessing" class="nav-link" data-scroll-target="#data-preprocessing"><span class="header-section-number">4.4</span> Data Preprocessing</a></li>
  <li>
<a href="#splitting-into-training-and-testing-sets" id="toc-splitting-into-training-and-testing-sets" class="nav-link" data-scroll-target="#splitting-into-training-and-testing-sets"><span class="header-section-number">4.5</span> Splitting into Training and Testing Sets</a>
  <ul class="collapse">
<li><a href="#when-to-split-the-data-before-or-after-preprocessing" id="toc-when-to-split-the-data-before-or-after-preprocessing" class="nav-link" data-scroll-target="#when-to-split-the-data-before-or-after-preprocessing"><span class="header-section-number">4.5.1</span> When to Split the Data: Before or After Preprocessing?</a></li>
  </ul>
</li>
  <li>
<a href="#defining-the-model" id="toc-defining-the-model" class="nav-link" data-scroll-target="#defining-the-model"><span class="header-section-number">4.6</span> Defining the Model</a>
  <ul class="collapse">
<li><a href="#lasso-regression-l1-regularization" id="toc-lasso-regression-l1-regularization" class="nav-link" data-scroll-target="#lasso-regression-l1-regularization"><span class="header-section-number">4.6.1</span> Lasso Regression (L1 Regularization)</a></li>
  <li><a href="#ridge-regression-l2-regularization" id="toc-ridge-regression-l2-regularization" class="nav-link" data-scroll-target="#ridge-regression-l2-regularization"><span class="header-section-number">4.6.2</span> Ridge Regression (L2 Regularization)</a></li>
  <li><a href="#elastic-net-regression" id="toc-elastic-net-regression" class="nav-link" data-scroll-target="#elastic-net-regression"><span class="header-section-number">4.6.3</span> Elastic Net Regression</a></li>
  </ul>
</li>
  <li>
<a href="#evaluating-the-models" id="toc-evaluating-the-models" class="nav-link" data-scroll-target="#evaluating-the-models"><span class="header-section-number">4.7</span> Evaluating the Models</a>
  <ul class="collapse">
<li><a href="#making-predictions" id="toc-making-predictions" class="nav-link" data-scroll-target="#making-predictions"><span class="header-section-number">4.7.1</span> Making Predictions</a></li>
  <li><a href="#calculating-rmse-and-r2" id="toc-calculating-rmse-and-r2" class="nav-link" data-scroll-target="#calculating-rmse-and-r2"><span class="header-section-number">4.7.2</span> Calculating RMSE and <span class="math inline">\(R^2\)</span></a></li>
  </ul>
</li>
  <li>
<a href="#tuning-the-regularization-parameters" id="toc-tuning-the-regularization-parameters" class="nav-link" data-scroll-target="#tuning-the-regularization-parameters"><span class="header-section-number">4.8</span> Tuning the Regularization Parameters</a>
  <ul class="collapse">
<li><a href="#setting-up-cross-validation" id="toc-setting-up-cross-validation" class="nav-link" data-scroll-target="#setting-up-cross-validation"><span class="header-section-number">4.8.1</span> Setting Up Cross-Validation</a></li>
  <li><a href="#defining-the-grid-for-tuning" id="toc-defining-the-grid-for-tuning" class="nav-link" data-scroll-target="#defining-the-grid-for-tuning"><span class="header-section-number">4.8.2</span> Defining the Grid for Tuning</a></li>
  <li><a href="#tuning-lasso-ridge-and-elastic-net" id="toc-tuning-lasso-ridge-and-elastic-net" class="nav-link" data-scroll-target="#tuning-lasso-ridge-and-elastic-net"><span class="header-section-number">4.8.3</span> Tuning Lasso, Ridge, and Elastic Net</a></li>
  <li><a href="#selecting-the-best-model" id="toc-selecting-the-best-model" class="nav-link" data-scroll-target="#selecting-the-best-model"><span class="header-section-number">4.8.4</span> Selecting the Best Model</a></li>
  <li><a href="#fitting-the-final-models" id="toc-fitting-the-final-models" class="nav-link" data-scroll-target="#fitting-the-final-models"><span class="header-section-number">4.8.5</span> Fitting the Final Models</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Linear Regression with Regularization</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><blockquote class="blockquote">
<p>“Other players may outplay me from time to time, but they’ll never outwork me.” - Tiger Woods</p>
</blockquote>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="pics/woods.jpg" class="img-fluid figure-img" width="200"></p>
<figcaption class="figure-caption">Tiger Woods tees off in the final round of the Masters in 2001, which he won by two strokes over David Duval. The win completed the “Tiger Slam,” Woods’ run of four consecutive major championship victories.</figcaption></figure>
</div>
<!-- ::: {.content-visible when-format="pdf"} -->
<!-- ![Frames from an animation of a tesseract, a cube changing over time. This appears as a true animation in the online version. -->
<!-- ](https://placeholder.co/400){#fig-tesseract} -->
<!-- ::: -->
<p>In the world of sports analytics, predicting player performance or team success can be highly complex due to the large number of variables involved. Linear regression serves as a foundational model for predicting continuous outcomes based on one or more predictor variables. However, in the case of many predictors, regularization methods like Lasso and Ridge regression are often used to enhance the model’s generalizability by adding penalty terms that discourage overfitting.</p>
<section id="introduction-to-regularization" class="level2" data-number="4.1"><h2 data-number="4.1" class="anchored" data-anchor-id="introduction-to-regularization">
<span class="header-section-number">4.1</span> Introduction to Regularization</h2>
<p>Regularization techniques modify the basic linear regression model by adding a penalty term to the loss function, which helps prevent overfitting, especially when there is a high number of predictor variables.</p>
<p>Overfitting occurs when a model becomes too complex and fits the noise or random fluctuations in the training data rather than capturing the underlying pattern. In simpler terms, an overfitted model performs exceptionally well on the training data but poorly on unseen data (test data) because it has learned the specific details and random patterns of the training set, which are not applicable to new data.</p>
<p>In sports analytics, overfitting can happen when we use too many variables or highly specific features, such as detailed player statistics that are not universally predictive across seasons or games. While the model may perform well on historical data, its predictive power decreases significantly when faced with new or future data, such as the next season’s performance.</p>
<p>Overfitting can be identified by looking for a large discrepancy between the performance of the model on the training data and the test data. For instance, if a model’s training error is very low but its test error is much higher, it’s a strong indication that overfitting has occurred.</p>
<p>Regularization techniques are designed to prevent overfitting by adding a penalty to the model’s complexity, effectively limiting the size of the coefficients and reducing the model’s sensitivity to noise in the training data.</p>
<p>The primary types of regularization are:</p>
<ul>
<li>
<strong>Ridge regression (L2 regularization)</strong>: Adds a penalty proportional to the square of the coefficients.</li>
<li>
<strong>Lasso regression (L1 regularization)</strong>: Adds a penalty proportional to the absolute value of the coefficients, encouraging sparse solutions where some coefficients are driven to zero.</li>
</ul>
<p>Both Ridge and Lasso are helpful when we want to reduce the complexity of the model by limiting the size of the regression coefficients. This is particularly useful when working with a large number of predictors, as is often the case in sports analytics.</p>
<section id="elastic-net-regularization" class="level3" data-number="4.1.1"><h3 data-number="4.1.1" class="anchored" data-anchor-id="elastic-net-regularization">
<span class="header-section-number">4.1.1</span> Elastic Net Regularization</h3>
<p>While Ridge and Lasso regression are two popular methods of regularization, <strong>Elastic Net</strong> combines elements of both Lasso and Ridge to create a more flexible and powerful regularization technique. Elastic Net is particularly useful when dealing with a large number of correlated predictors, a common scenario in sports analytics where multiple factors (e.g., player statistics, team metrics) are often highly interrelated.</p>
<p>Elastic Net regularization works by adding both the L1 penalty (from Lasso) and the L2 penalty (from Ridge) to the loss function. The model can be tuned to emphasize either the L1 or the L2 penalty, or a balance between the two, depending on the characteristics of the data.</p>
<section id="elastic-net-formula" class="level4"><h4 class="anchored" data-anchor-id="elastic-net-formula">Elastic Net Formula</h4>
<p>The Elastic Net penalty term is a linear combination of the L1 and L2 penalties:</p>
<p><span class="math display">\[
\text{Penalty} = \alpha \cdot \lambda_1 \cdot \sum_{j} |\beta_j| + (1 - \alpha) \cdot \lambda_2 \cdot \sum_{j} \beta_j^2
\]</span></p>
<p>Where:</p>
<ul>
<li>
<span class="math inline">\(\lambda_i\)</span> is the regularization strength (a non-negative constant).</li>
<li>
<span class="math inline">\(\alpha\)</span> controls the mixing between Lasso and Ridge:
<ul>
<li>If <span class="math inline">\(\alpha = 1\)</span>, Elastic Net behaves like Lasso (L1 regularization).</li>
<li>If <span class="math inline">\(\alpha = 0\)</span>, Elastic Net behaves like Ridge (L2 regularization).</li>
<li>Values between 0 and 1 represent a mix of Lasso and Ridge.</li>
</ul>
</li>
</ul>
<p>Elastic Net is especially advantageous when:</p>
<ul>
<li>
<strong>There are many correlated features</strong>: Lasso tends to pick one feature from a group of highly correlated features and discard the rest, which might not be ideal when all features are relevant. Ridge, on the other hand, tends to shrink the coefficients of correlated predictors equally, but this may not result in a sparse model.</li>
<li>
<strong>When you want to maintain the strengths of both Ridge and Lasso</strong>: Elastic Net can provide a balance between variable selection (via Lasso’s L1 penalty) and coefficient shrinkage (via Ridge’s L2 penalty), making it more robust in various scenarios.</li>
</ul></section></section></section><section id="the-pga2022.csv-dataset" class="level2" data-number="4.2"><h2 data-number="4.2" class="anchored" data-anchor-id="the-pga2022.csv-dataset">
<span class="header-section-number">4.2</span> The <code>PGA2022.csv</code> dataset</h2>
<p>To demonstrate these methods, we will use the <code>PGA2022.csv</code> dataset. Each row in the dataset gives the measures for one golfer in one tournament. The dataset covers 19 PGA tournaments from the 2022 season with 1387 cases in all. Each tournament consists of four rounds of golf. Some golfers are eliminated after the first two (or sometimes three) rounds. Only players who competed in all four rounds (i.e.&nbsp;those that made the “cut”) are included in this dataset. Below are the variables:</p>
<ul>
<li>
<code>playerName</code>: Name of the player</li>
<li>
<code>country</code>: The country where the player is from</li>
<li>
<code>avgDriveDist</code>: Average driving distance (in yards)</li>
<li>
<code>drivePct</code>: Percentage of times a tee shot comes to rest in the fairway</li>
<li>
<code>driveSG</code>: Strokes gained off the tee measures player performance off the tee on all par 4s and par 5s of how much better or worse a player’s drive is than the PGA Tour average</li>
<li>
<code>avgPuttsPerRound</code>: Average number of total putts per round</li>
<li>
<code>onePuttPct</code>: Percentage of times it took one putt to get the ball into the hole</li>
<li>
<code>puttsSG</code>: Strokes gained putting measures how many strokes a player gains or loses on the greens compared to the PGA Tour average</li>
<li>
<code>avgScore</code>: The scoring average is the total strokes divided by the total rounds</li>
<li>
<code>Money</code>: The official money is the prize money award to the Professional members</li>
<li>
<code>Points</code>: FedexCup Regular Season Points are awarded points by finished position for performance in each tournament</li>
<li>
<code>Tournament</code>: The tournament where the PGA Tour is taking place</li>
</ul>
<p>We’ll use the <code>parsnip</code> package from <code>tidymodels</code> to fit both Ridge and Lasso regression models.</p>
</section><section id="loading-and-preparing-the-data" class="level2" data-number="4.3"><h2 data-number="4.3" class="anchored" data-anchor-id="loading-and-preparing-the-data">
<span class="header-section-number">4.3</span> Loading and Preparing the Data</h2>
<p>First, let’s load the dataset and take a look at its structure.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org">tidymodels</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">golf_data</span> <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"data/PGA2022.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">golf_data</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,387
Columns: 13
$ ...1             &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16…
$ playerName       &lt;chr&gt; "Luke List", "Will Zalatoris", "Joseph Bramlett", "Wy…
$ country          &lt;chr&gt; "United States", "United States", "United States", "U…
$ avgDriveDist     &lt;dbl&gt; 319.5, 317.4, 315.3, 313.0, 311.1, 310.6, 310.5, 310.…
$ drivePct         &lt;dbl&gt; 60.71, 58.93, 73.21, 62.50, 62.50, 66.07, 60.71, 69.6…
$ avgPuttsPerRound &lt;dbl&gt; 28.00, 26.50, 28.50, 27.00, 28.50, 28.75, 28.00, 26.5…
$ onePuttPct       &lt;dbl&gt; 43.06, 47.22, 43.06, 47.22, 44.44, 33.33, 41.67, 44.4…
$ driveSG          &lt;dbl&gt; 0.724, 0.787, 1.554, 0.352, 1.297, 1.407, 1.139, -0.9…
$ puttsSG          &lt;dbl&gt; -0.529, -0.752, -0.045, 0.500, 0.190, -0.529, 0.475, …
$ avgScore         &lt;dbl&gt; 70.510, 69.435, 70.173, 70.435, 69.935, 69.760, 70.68…
$ Money            &lt;dbl&gt; 79420, 256500, 39683, 161500, 207100, 184300, 119700,…
$ Points           &lt;dbl&gt; 39, 92, 20, 60, 75, 68, 50, 8, 5, 30, 12, 12, 500, 80…
$ tournament       &lt;chr&gt; "The American Express", "The American Express", "The …</code></pre>
</div>
</div>
</section><section id="data-preprocessing" class="level2" data-number="4.4"><h2 data-number="4.4" class="anchored" data-anchor-id="data-preprocessing">
<span class="header-section-number">4.4</span> Data Preprocessing</h2>
<p>We’ll use the <code>recipes</code> package from <code>tidymodels</code> to preprocess the data before fitting the models. The <code>recipe</code> function allows us to define the necessary preprocessing steps in a pipeline, ensuring that the data is appropriately prepared for modeling.</p>
<p>We’ll start by performing the following steps:</p>
<ol type="1">
<li>
<strong>Handling Missing Data</strong>: Remove any rows with missing values.</li>
<li>
<strong>Feature Selection</strong>: Select only the relevant predictor variables for the model.</li>
<li>
<strong>Scaling and Centering</strong>: Scale the numerical predictors so that they have a mean of 0 and a standard deviation of 1. This is especially important for regularization models, as the penalty terms are sensitive to the scale of the variables.</li>
</ol>
<p>Let’s create a recipe for preprocessing the golf dataset:</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">golf_recipe</span> <span class="op">=</span> <span class="fu">recipe</span><span class="op">(</span><span class="va">Points</span> <span class="op">~</span> <span class="va">avgDriveDist</span> <span class="op">+</span> <span class="va">drivePct</span> <span class="op">+</span> <span class="va">driveSG</span> <span class="op">+</span> </span>
<span>                        <span class="va">avgPuttsPerRound</span> <span class="op">+</span> <span class="va">onePuttPct</span> <span class="op">+</span> <span class="va">puttsSG</span>, </span>
<span>                      data <span class="op">=</span> <span class="va">golf_data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">step_naomit</span><span class="op">(</span><span class="fu">all_predictors</span><span class="op">(</span><span class="op">)</span>, <span class="va">Points</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">step_normalize</span><span class="op">(</span><span class="fu">all_numeric_predictors</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">prepped_recipe</span> <span class="op">=</span> <span class="fu">prep</span><span class="op">(</span><span class="va">golf_recipe</span>, training <span class="op">=</span> <span class="va">golf_data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">processed_data</span> <span class="op">=</span> <span class="fu">bake</span><span class="op">(</span><span class="va">prepped_recipe</span>, new_data <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">processed_data</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,313
Columns: 7
$ avgDriveDist     &lt;dbl&gt; 1.21659476, 1.06586384, 0.91513291, 0.75004666, 0.613…
$ drivePct         &lt;dbl&gt; 0.01282035, -0.16777722, 1.28106170, 0.19443251, 0.19…
$ driveSG          &lt;dbl&gt; 0.9362623, 1.0364409, 2.2560757, 0.3447315, 1.8474106…
$ avgPuttsPerRound &lt;dbl&gt; -0.4514846, -1.5157562, -0.0967274, -1.1609990, -0.09…
$ onePuttPct       &lt;dbl&gt; 0.35409234, 0.98615311, 0.35409234, 0.98615311, 0.563…
$ puttsSG          &lt;dbl&gt; -0.92076989, -1.17574961, -0.36736101, 0.25579569, -0…
$ Points           &lt;dbl&gt; 39, 92, 20, 60, 75, 68, 50, 8, 5, 30, 12, 12, 500, 80…</code></pre>
</div>
</div>
<section id="explanation-of-the-recipe-steps" class="level4"><h4 class="anchored" data-anchor-id="explanation-of-the-recipe-steps">Explanation of the Recipe Steps:</h4>
<ul>
<li><p><code>step_naomit(all_predictors(), Points)</code>: This step removes any rows with missing values in the predictors or in the response variable <code>Points</code>. This is useful for cleaning the data and ensuring that the model is not affected by missing values.</p></li>
<li><p><code>step_normalize(all_numeric_predictors())</code>: Normalizing the numeric predictors is crucial for models that involve regularization, as it ensures that all variables are on the same scale. This step scales the predictors so that they each have a mean of 0 and a standard deviation of 1.</p></li>
</ul>
<p>After applying the recipe, we can see the processed data with all the necessary transformations.</p>
</section></section><section id="splitting-into-training-and-testing-sets" class="level2" data-number="4.5"><h2 data-number="4.5" class="anchored" data-anchor-id="splitting-into-training-and-testing-sets">
<span class="header-section-number">4.5</span> Splitting into Training and Testing Sets</h2>
<p>In any predictive modeling task, it’s crucial to evaluate the model’s performance on data that it has not seen before. To achieve this, we split the dataset into two parts: a training set used to fit the model, and a testing set used to evaluate the model’s performance. A common approach is to allocate 80% of the data to the training set and 20% to the testing set.</p>
<p>We can use the <code>initial_split()</code> function from the <code>rsample</code> package, which is part of the <code>tidymodels</code> ecosystem, to split the data into training and testing sets. The split function randomly selects the specified proportion of data for the training set, while the remaining data is reserved for testing.</p>
<p>Let’s split the golf data:</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1004</span><span class="op">)</span>  </span>
<span><span class="va">split</span> <span class="op">=</span> <span class="fu">initial_split</span><span class="op">(</span><span class="va">golf_data</span>, prop <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span></span>
<span><span class="va">train_data</span> <span class="op">=</span> <span class="fu">training</span><span class="op">(</span><span class="va">split</span><span class="op">)</span></span>
<span><span class="va">test_data</span> <span class="op">=</span> <span class="fu">testing</span><span class="op">(</span><span class="va">split</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>By splitting the data in this way, we ensure that the model will be trained on one subset of the data and tested on an entirely different subset, providing a more accurate measure of its performance on unseen data.</p>
<section id="when-to-split-the-data-before-or-after-preprocessing" class="level3" data-number="4.5.1"><h3 data-number="4.5.1" class="anchored" data-anchor-id="when-to-split-the-data-before-or-after-preprocessing">
<span class="header-section-number">4.5.1</span> When to Split the Data: Before or After Preprocessing?</h3>
<p>When working with machine learning or statistical models, one important decision is whether to split the dataset before or after the preprocessing stage. Both approaches have their implications, and understanding the correct order can help avoid potential data leakage and ensure the validity of your model’s evaluation.</p>
<section id="splitting-before-preprocessing" class="level4"><h4 class="anchored" data-anchor-id="splitting-before-preprocessing">Splitting Before Preprocessing</h4>
<p><strong>Advantages</strong>:</p>
<ul>
<li>
<strong>Avoids Data Leakage</strong>: If you split the data first, the training set remains entirely separate from the testing set during the entire preprocessing process. This ensures that no information from the test set is used in the preprocessing of the training data, which could lead to an overestimation of the model’s performance (i.e., data leakage).</li>
<li>
<strong>Realistic Evaluation</strong>: Splitting before preprocessing mimics a real-world scenario where you wouldn’t have access to the entire dataset when making predictions on new data. By applying preprocessing only to the training data, we ensure that the model is evaluated on truly unseen data, which is a more realistic test of its generalizability.</li>
</ul>
<p>First, split the data into training and testing sets. Then, apply preprocessing steps like normalization, missing value imputation, or feature engineering <strong>only</strong> to the training data. The testing data should remain untouched and be used only for final evaluation.</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1004</span><span class="op">)</span></span>
<span><span class="va">split</span> <span class="op">=</span> <span class="fu">initial_split</span><span class="op">(</span><span class="va">golf_data</span>, prop <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="va">train_data</span> <span class="op">=</span> <span class="fu">training</span><span class="op">(</span><span class="va">split</span><span class="op">)</span></span>
<span><span class="va">test_data</span> <span class="op">=</span> <span class="fu">testing</span><span class="op">(</span><span class="va">split</span><span class="op">)</span></span>
<span> </span>
<span><span class="va">golf_recipe</span> <span class="op">=</span> <span class="fu">recipe</span><span class="op">(</span><span class="va">Points</span> <span class="op">~</span> <span class="va">avgDriveDist</span> <span class="op">+</span> <span class="va">drivePct</span> <span class="op">+</span> <span class="va">driveSG</span> <span class="op">+</span> </span>
<span>                        <span class="va">avgPuttsPerRound</span> <span class="op">+</span> <span class="va">onePuttPct</span> <span class="op">+</span> <span class="va">puttsSG</span>, </span>
<span>                      data <span class="op">=</span> <span class="va">train_data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">step_naomit</span><span class="op">(</span><span class="fu">all_predictors</span><span class="op">(</span><span class="op">)</span>, <span class="va">Points</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">step_normalize</span><span class="op">(</span><span class="fu">all_numeric_predictors</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">prepped_recipe</span> <span class="op">=</span> <span class="fu">prep</span><span class="op">(</span><span class="va">golf_recipe</span>, training <span class="op">=</span> <span class="va">train_data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">processed_train_data</span> <span class="op">=</span> <span class="fu">bake</span><span class="op">(</span><span class="va">prepped_recipe</span>, new_data <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="va">processed_test_data</span> <span class="op">=</span> <span class="fu">bake</span><span class="op">(</span><span class="va">prepped_recipe</span>, new_data <span class="op">=</span> <span class="va">test_data</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="splitting-after-preprocessing" class="level4"><h4 class="anchored" data-anchor-id="splitting-after-preprocessing">Splitting After Preprocessing</h4>
<p><strong>Potential for Data Leakage</strong>: If you preprocess the entire dataset before splitting, the test data may influence the preprocessing of the training data. For example, when normalizing the data, using the entire dataset could result in a situation where information from the test data (such as the mean or standard deviation) is inadvertently used to transform the training data. This can lead to a more optimistic estimate of the model’s performance, as it’s effectively “leaking” knowledge from the test set into the training process.</p>
<p>The best practice is to <strong>split the data before preprocessing</strong> to avoid data leakage and ensure that the test set remains a true representation of unseen data. By preprocessing only the training data and then applying the same transformations to the test set, we ensure that the model’s evaluation is based solely on data that the model has not seen during the training phase.</p>
<p>This approach allows for an honest evaluation of how well the model will perform on truly new data, reflecting the challenges faced in real-world predictions.</p>
</section></section></section><section id="defining-the-model" class="level2" data-number="4.6"><h2 data-number="4.6" class="anchored" data-anchor-id="defining-the-model">
<span class="header-section-number">4.6</span> Defining the Model</h2>
<p>After preprocessing the data and splitting it into training and testing sets, we can proceed to define the regression models. In this section, we will define models for <strong>Lasso</strong>, <strong>Ridge</strong>, and <strong>Elastic Net</strong> regularization using the <code>parsnip</code> package from <code>tidymodels</code>. These regularization techniques help reduce overfitting and improve the generalizability of the model, especially when working with many predictors.</p>
<section id="lasso-regression-l1-regularization" class="level3" data-number="4.6.1"><h3 data-number="4.6.1" class="anchored" data-anchor-id="lasso-regression-l1-regularization">
<span class="header-section-number">4.6.1</span> Lasso Regression (L1 Regularization)</h3>
<p>Lasso regression applies L1 regularization, which adds a penalty proportional to the absolute value of the coefficients. This penalty encourages sparsity, meaning some of the coefficients may be driven to zero, effectively performing feature selection.</p>
<p>In <code>tidymodels</code>, we can define the Lasso regression model as follows:</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lasso_model</span> <span class="op">=</span> <span class="fu">linear_reg</span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">0.1</span>, mixture <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_engine</span><span class="op">(</span><span class="st">"glmnet"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_mode</span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lasso_fit</span> <span class="op">=</span> <span class="fu">fit</span><span class="op">(</span><span class="va">lasso_model</span>, <span class="va">Points</span> <span class="op">~</span> <span class="va">avgDriveDist</span> <span class="op">+</span> <span class="va">drivePct</span> <span class="op">+</span> <span class="va">driveSG</span> <span class="op">+</span> </span>
<span>                   <span class="va">avgPuttsPerRound</span> <span class="op">+</span> <span class="va">onePuttPct</span> <span class="op">+</span> <span class="va">puttsSG</span>, </span>
<span>                 data <span class="op">=</span> <span class="va">processed_train_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View the fitted model</span></span>
<span><span class="va">lasso_fit</span> <span class="op">|&gt;</span> <span class="fu">tidy</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 3
  term             estimate penalty
  &lt;chr&gt;               &lt;dbl&gt;   &lt;dbl&gt;
1 (Intercept)        43.6       0.1
2 avgDriveDist        1.49      0.1
3 drivePct            0.570     0.1
4 driveSG            22.0       0.1
5 avgPuttsPerRound   -6.88      0.1
6 onePuttPct         -3.05      0.1
7 puttsSG            25.8       0.1</code></pre>
</div>
</div>
<section id="explanation" class="level4"><h4 class="anchored" data-anchor-id="explanation">Explanation:</h4>
<ul>
<li>
<strong><code>penalty = 0.1</code></strong>: The penalty parameter controls the strength of the regularization. A higher penalty results in more shrinkage of the coefficients.</li>
<li>
<strong><code>mixture = 1</code></strong>: Setting <code>mixture</code> to 1 specifies that we are using Lasso (L1 regularization). If it were set to 0, it would correspond to Ridge regression (L2 regularization).</li>
</ul></section></section><section id="ridge-regression-l2-regularization" class="level3" data-number="4.6.2"><h3 data-number="4.6.2" class="anchored" data-anchor-id="ridge-regression-l2-regularization">
<span class="header-section-number">4.6.2</span> Ridge Regression (L2 Regularization)</h3>
<p>Ridge regression applies L2 regularization, which adds a penalty proportional to the square of the coefficients. This type of regularization does not result in sparse solutions, but rather shrinks the coefficients toward zero.</p>
<p>We define the Ridge regression model as follows:</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ridge_model</span> <span class="op">=</span> <span class="fu">linear_reg</span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">0.1</span>, mixture <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_engine</span><span class="op">(</span><span class="st">"glmnet"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_mode</span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">ridge_fit</span> <span class="op">=</span> <span class="fu">fit</span><span class="op">(</span><span class="va">ridge_model</span>, <span class="va">Points</span> <span class="op">~</span> <span class="va">avgDriveDist</span> <span class="op">+</span> <span class="va">drivePct</span> <span class="op">+</span> <span class="va">driveSG</span> <span class="op">+</span> </span>
<span>                  <span class="va">avgPuttsPerRound</span> <span class="op">+</span> <span class="va">onePuttPct</span> <span class="op">+</span> <span class="va">puttsSG</span>, </span>
<span>                 data <span class="op">=</span> <span class="va">processed_train_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View the fitted model</span></span>
<span><span class="va">ridge_fit</span> <span class="op">|&gt;</span> <span class="fu">tidy</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 3
  term             estimate penalty
  &lt;chr&gt;               &lt;dbl&gt;   &lt;dbl&gt;
1 (Intercept)         43.6      0.1
2 avgDriveDist         2.01     0.1
3 drivePct             1.20     0.1
4 driveSG             20.9      0.1
5 avgPuttsPerRound    -6.61     0.1
6 onePuttPct          -2.32     0.1
7 puttsSG             24.7      0.1</code></pre>
</div>
</div>
<section id="explanation-1" class="level4"><h4 class="anchored" data-anchor-id="explanation-1">Explanation:</h4>
<ul>
<li>
<strong><code>penalty = 0.1</code></strong>: This controls the regularization strength, as described for Lasso.</li>
<li>
<strong><code>mixture = 0</code></strong>: Setting <code>mixture</code> to 0 specifies that we are using Ridge regression (L2 regularization). If it were set to 1, it would correspond to Lasso (L1 regularization).</li>
</ul></section></section><section id="elastic-net-regression" class="level3" data-number="4.6.3"><h3 data-number="4.6.3" class="anchored" data-anchor-id="elastic-net-regression">
<span class="header-section-number">4.6.3</span> Elastic Net Regression</h3>
<p>Elastic Net is a combination of L1 and L2 regularization, balancing the strengths of both Lasso and Ridge. It is especially useful when dealing with highly correlated features, as it can retain relevant features while also shrinking the coefficients of others.</p>
<p>To define the Elastic Net model, we specify a mixture between Lasso and Ridge, where the mixture parameter controls the balance between L1 and L2 regularization:</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">elastic_net_model</span> <span class="op">=</span> <span class="fu">linear_reg</span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">0.1</span>, mixture <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_engine</span><span class="op">(</span><span class="st">"glmnet"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_mode</span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">elastic_net_fit</span> <span class="op">=</span> <span class="fu">fit</span><span class="op">(</span><span class="va">elastic_net_model</span>, <span class="va">Points</span> <span class="op">~</span> <span class="va">avgDriveDist</span> <span class="op">+</span> <span class="va">drivePct</span> <span class="op">+</span> <span class="va">driveSG</span> <span class="op">+</span> </span>
<span>                        <span class="va">avgPuttsPerRound</span> <span class="op">+</span> <span class="va">onePuttPct</span> <span class="op">+</span> <span class="va">puttsSG</span>, </span>
<span>                       data <span class="op">=</span> <span class="va">processed_train_data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">elastic_net_fit</span> <span class="op">|&gt;</span> <span class="fu">tidy</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 3
  term             estimate penalty
  &lt;chr&gt;               &lt;dbl&gt;   &lt;dbl&gt;
1 (Intercept)        43.6       0.1
2 avgDriveDist        1.57      0.1
3 drivePct            0.646     0.1
4 driveSG            22.0       0.1
5 avgPuttsPerRound   -7.31      0.1
6 onePuttPct         -3.49      0.1
7 puttsSG            25.8       0.1</code></pre>
</div>
</div>
<section id="explanation-2" class="level4"><h4 class="anchored" data-anchor-id="explanation-2">Explanation:</h4>
<ul>
<li>
<strong><code>penalty = 0.1</code></strong>: This is the regularization strength for the Elastic Net model, just like with Lasso and Ridge.</li>
<li>
<strong><code>mixture = 0.5</code></strong>: This sets the balance between Lasso (L1) and Ridge (L2) regularization. A mixture of 0.5 means that both penalties are equally weighted. Values closer to 1 favor Lasso, and values closer to 0 favor Ridge.</li>
</ul></section></section></section><section id="evaluating-the-models" class="level2" data-number="4.7"><h2 data-number="4.7" class="anchored" data-anchor-id="evaluating-the-models">
<span class="header-section-number">4.7</span> Evaluating the Models</h2>
<p>Once the models for <strong>Lasso</strong>, <strong>Ridge</strong>, and <strong>Elastic Net</strong> regression are trained, it’s essential to evaluate their performance on the testing set. Evaluation helps us understand how well the model generalizes to new, unseen data. Common performance metrics for regression models include <strong>Root Mean Squared Error (RMSE)</strong>, <strong>Mean Absolute Error (MAE)</strong>, and <strong>R-squared (<span class="math inline">\(R^2\)</span>)</strong>.</p>
<p>In this section, we will use the <strong>RMSE</strong> and <strong><span class="math inline">\(R^2\)</span></strong> metrics to evaluate the performance of each model.</p>
<section id="making-predictions" class="level3" data-number="4.7.1"><h3 data-number="4.7.1" class="anchored" data-anchor-id="making-predictions">
<span class="header-section-number">4.7.1</span> Making Predictions</h3>
<p>First, we use the fitted models to make predictions on the testing set.</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lasso_preds</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">lasso_fit</span>, new_data <span class="op">=</span> <span class="va">processed_test_data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ridge_preds</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">ridge_fit</span>, new_data <span class="op">=</span> <span class="va">processed_test_data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">elastic_net_preds</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">elastic_net_fit</span>, new_data <span class="op">=</span> <span class="va">processed_test_data</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="calculating-rmse-and-r2" class="level3" data-number="4.7.2"><h3 data-number="4.7.2" class="anchored" data-anchor-id="calculating-rmse-and-r2">
<span class="header-section-number">4.7.2</span> Calculating RMSE and <span class="math inline">\(R^2\)</span>
</h3>
<p>Now, we can calculate the <strong>Root Mean Squared Error (RMSE)</strong> and <strong>R-squared (<span class="math inline">\(R^2\)</span>)</strong> for each model to evaluate their predictive performance. The RMSE gives us an idea of the average magnitude of error between the predicted and actual values, while <span class="math inline">\(R^2\)</span> explains how well the model explains the variability in the dependent variable.</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dat</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html">bind_cols</a></span><span class="op">(</span><span class="va">processed_test_data</span>, <span class="va">lasso_preds</span><span class="op">)</span></span>
<span><span class="va">lasso_rmse</span> <span class="op">=</span> <span class="va">dat</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">rmse</span><span class="op">(</span>truth <span class="op">=</span> <span class="va">Points</span>, estimate <span class="op">=</span> <span class="va">.pred</span><span class="op">)</span></span>
<span><span class="va">lasso_r2</span> <span class="op">=</span> <span class="va">dat</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">rsq</span><span class="op">(</span>truth <span class="op">=</span> <span class="va">Points</span>, estimate <span class="op">=</span> <span class="va">.pred</span><span class="op">)</span></span>
<span>  </span>
<span></span>
<span><span class="va">dat</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html">bind_cols</a></span><span class="op">(</span><span class="va">processed_test_data</span>, <span class="va">ridge_preds</span><span class="op">)</span></span>
<span><span class="va">ridge_rmse</span> <span class="op">=</span> <span class="va">dat</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">rmse</span><span class="op">(</span>truth <span class="op">=</span> <span class="va">Points</span>, estimate <span class="op">=</span> <span class="va">.pred</span><span class="op">)</span></span>
<span><span class="va">ridge_r2</span> <span class="op">=</span> <span class="va">dat</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">rsq</span><span class="op">(</span>truth <span class="op">=</span> <span class="va">Points</span>, estimate <span class="op">=</span> <span class="va">.pred</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html">bind_cols</a></span><span class="op">(</span><span class="va">processed_test_data</span>, <span class="va">elastic_net_preds</span><span class="op">)</span></span>
<span><span class="va">elastic_net_rmse</span> <span class="op">=</span> <span class="va">dat</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">rmse</span><span class="op">(</span>truth <span class="op">=</span> <span class="va">Points</span>, estimate <span class="op">=</span> <span class="va">.pred</span><span class="op">)</span></span>
<span><span class="va">elastic_net_r2</span> <span class="op">=</span> <span class="va">dat</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">rsq</span><span class="op">(</span>truth <span class="op">=</span> <span class="va">Points</span>, estimate <span class="op">=</span> <span class="va">.pred</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print the results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Lasso RMSE: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">lasso_rmse</span><span class="op">$</span><span class="va">.estimate</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Lasso RMSE:  63.42"</code></pre>
</div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Lasso R2: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">lasso_r2</span><span class="op">$</span><span class="va">.estimate</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Lasso R2:  0.19"</code></pre>
</div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Ridge RMSE: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">ridge_rmse</span><span class="op">$</span><span class="va">.estimate</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Ridge RMSE:  63.35"</code></pre>
</div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Ridge R2: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">ridge_r2</span><span class="op">$</span><span class="va">.estimate</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Ridge R2:  0.19"</code></pre>
</div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Elastic Net RMSE: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">elastic_net_rmse</span><span class="op">$</span><span class="va">.estimate</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Elastic Net RMSE:  63.42"</code></pre>
</div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Elastic Net R2: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">elastic_net_r2</span><span class="op">$</span><span class="va">.estimate</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Elastic Net R2:  0.19"</code></pre>
</div>
</div>
<section id="explanation-3" class="level4"><h4 class="anchored" data-anchor-id="explanation-3">Explanation:</h4>
<ul>
<li>
<strong>RMSE (Root Mean Squared Error)</strong>: Measures the average squared difference between predicted and actual values. Lower values indicate a better fit.</li>
<li>
<strong><span class="math inline">\(R^2\)</span> (R-squared)</strong>: Represents the proportion of the variance in the dependent variable that is predictable from the independent variables. An <span class="math inline">\(R^2\)</span> value closer to 1 indicates a better fit.</li>
</ul>
<!-- ### Visualizing Model Performance --><!-- To better understand the performance of the models, we can visualize the predicted versus actual values using scatter plots. This will help us see how closely the predictions follow the true values. --><!-- ```{r} --><!-- ggplot(data = processed_test_data, aes(x = Points, y = lasso_preds$.pred)) + --><!--   geom_point() + --><!--   ggtitle("Lasso: Actual vs Predicted") + --><!--   xlab("Actual Points") + ylab("Predicted Points") --><!-- ``` --><!-- ```{r} --><!-- ggplot(data = processed_test_data, aes(x = Points, y = ridge_preds$.pred)) + --><!--   geom_point() + --><!--   ggtitle("Ridge: Actual vs Predicted") + --><!--   xlab("Actual Points") + ylab("Predicted Points") --><!-- ``` --><!-- ```{r} --><!-- ggplot(data = processed_test_data, aes(x = Points, y = elastic_net_preds$.pred)) + --><!--   geom_point() + --><!--   ggtitle("Elastic Net: Actual vs Predicted") + --><!--   xlab("Actual Points") + ylab("Predicted Points") --><!-- ``` --><!-- These plots provide a visual comparison between the actual and predicted values, helping us evaluate how well the model fits the data. --></section></section></section><section id="tuning-the-regularization-parameters" class="level2" data-number="4.8"><h2 data-number="4.8" class="anchored" data-anchor-id="tuning-the-regularization-parameters">
<span class="header-section-number">4.8</span> Tuning the Regularization Parameters</h2>
<p>While the regularization techniques like Lasso, Ridge, and Elastic Net provide a mechanism to prevent overfitting, the strength of the regularization (penalty) is controlled by a hyperparameter, often denoted as <strong>penalty</strong> or <strong>lambda</strong>. Tuning this parameter is crucial because it directly influences the model’s ability to generalize.</p>
<p>The optimal value of the regularization parameter can be found using <strong>cross-validation</strong>. Cross-validation helps us evaluate the model’s performance on different subsets of the data, ensuring that the chosen parameter provides the best trade-off between bias and variance.</p>
<p>In this section, we will demonstrate how to tune the regularization parameter for each of the models (Lasso, Ridge, and Elastic Net) using <strong>grid search</strong> with cross-validation.</p>
<section id="setting-up-cross-validation" class="level3" data-number="4.8.1"><h3 data-number="4.8.1" class="anchored" data-anchor-id="setting-up-cross-validation">
<span class="header-section-number">4.8.1</span> Setting Up Cross-Validation</h3>
<p>We will first define a cross-validation procedure using <code>vfold_cv()</code> from the <code>rsample</code> package. We will perform 5-fold cross-validation, meaning the data will be split into 5 folds, with each fold being used as a test set while the remaining folds are used for training.</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1004</span><span class="op">)</span></span>
<span><span class="va">cv_folds</span> <span class="op">=</span> <span class="fu">vfold_cv</span><span class="op">(</span><span class="va">processed_train_data</span>, v <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="defining-the-grid-for-tuning" class="level3" data-number="4.8.2"><h3 data-number="4.8.2" class="anchored" data-anchor-id="defining-the-grid-for-tuning">
<span class="header-section-number">4.8.2</span> Defining the Grid for Tuning</h3>
<p>We will create a grid of possible values for the <strong>penalty</strong> parameter. This grid will range from low values (less regularization) to high values (more regularization). We will also tune the <strong>mixture</strong> parameter for the Elastic Net model, which controls the balance between Lasso and Ridge regularization.</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">penalty_grid</span> <span class="op">=</span> <span class="fu">grid_regular</span><span class="op">(</span><span class="fu">penalty</span><span class="op">(</span>range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, levels <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">elastic_net_grid</span> <span class="op">=</span> <span class="fu">grid_regular</span><span class="op">(</span></span>
<span>  <span class="fu">penalty</span><span class="op">(</span>range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, </span>
<span>  <span class="fu">mixture</span><span class="op">(</span>range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, </span>
<span>  levels <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="tuning-lasso-ridge-and-elastic-net" class="level3" data-number="4.8.3"><h3 data-number="4.8.3" class="anchored" data-anchor-id="tuning-lasso-ridge-and-elastic-net">
<span class="header-section-number">4.8.3</span> Tuning Lasso, Ridge, and Elastic Net</h3>
<p>We will now tune the <strong>Lasso</strong>, <strong>Ridge</strong>, and <strong>Elastic Net</strong> models by applying the grid of penalties. We will use the <code>tune_grid()</code> function from <code>tidymodels</code> to perform cross-validation for each model.</p>
<section id="tuning-lasso" class="level4"><h4 class="anchored" data-anchor-id="tuning-lasso">Tuning Lasso</h4>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lasso_model</span> <span class="op">=</span> <span class="fu">linear_reg</span><span class="op">(</span>penalty <span class="op">=</span> <span class="fu">tune</span><span class="op">(</span><span class="op">)</span>, mixture <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_engine</span><span class="op">(</span><span class="st">"glmnet"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_mode</span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lasso_tune</span> <span class="op">=</span> <span class="fu">tune_grid</span><span class="op">(</span></span>
<span>  <span class="va">lasso_model</span>,</span>
<span>  <span class="va">Points</span> <span class="op">~</span> <span class="va">avgDriveDist</span> <span class="op">+</span> <span class="va">drivePct</span> <span class="op">+</span> <span class="va">driveSG</span> <span class="op">+</span> </span>
<span>    <span class="va">avgPuttsPerRound</span> <span class="op">+</span> <span class="va">onePuttPct</span> <span class="op">+</span> <span class="va">puttsSG</span>,</span>
<span>  resamples <span class="op">=</span> <span class="va">cv_folds</span>,</span>
<span>  grid <span class="op">=</span> <span class="va">penalty_grid</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="tuning-ridge" class="level4"><h4 class="anchored" data-anchor-id="tuning-ridge">Tuning Ridge</h4>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ridge_model</span> <span class="op">=</span> <span class="fu">linear_reg</span><span class="op">(</span>penalty <span class="op">=</span> <span class="fu">tune</span><span class="op">(</span><span class="op">)</span>, mixture <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_engine</span><span class="op">(</span><span class="st">"glmnet"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_mode</span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ridge_tune</span> <span class="op">=</span> <span class="fu">tune_grid</span><span class="op">(</span></span>
<span>  <span class="va">ridge_model</span>,</span>
<span>  <span class="va">Points</span> <span class="op">~</span> <span class="va">avgDriveDist</span> <span class="op">+</span> <span class="va">drivePct</span> <span class="op">+</span> <span class="va">driveSG</span> <span class="op">+</span> </span>
<span>    <span class="va">avgPuttsPerRound</span> <span class="op">+</span> <span class="va">onePuttPct</span> <span class="op">+</span> <span class="va">puttsSG</span>,</span>
<span>  resamples <span class="op">=</span> <span class="va">cv_folds</span>,</span>
<span>  grid <span class="op">=</span> <span class="va">penalty_grid</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="tuning-elastic-net" class="level4"><h4 class="anchored" data-anchor-id="tuning-elastic-net">Tuning Elastic Net</h4>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">elastic_net_model</span> <span class="op">=</span> <span class="fu">linear_reg</span><span class="op">(</span>penalty <span class="op">=</span> <span class="fu">tune</span><span class="op">(</span><span class="op">)</span>, mixture <span class="op">=</span> <span class="fu">tune</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_engine</span><span class="op">(</span><span class="st">"glmnet"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_mode</span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">elastic_net_tune</span> <span class="op">=</span> <span class="fu">tune_grid</span><span class="op">(</span></span>
<span>  <span class="va">elastic_net_model</span>,</span>
<span>  <span class="va">Points</span> <span class="op">~</span> <span class="va">avgDriveDist</span> <span class="op">+</span> <span class="va">drivePct</span> <span class="op">+</span> <span class="va">driveSG</span> <span class="op">+</span> </span>
<span>    <span class="va">avgPuttsPerRound</span> <span class="op">+</span> <span class="va">onePuttPct</span> <span class="op">+</span> <span class="va">puttsSG</span>,</span>
<span>  resamples <span class="op">=</span> <span class="va">cv_folds</span>,</span>
<span>  grid <span class="op">=</span> <span class="va">elastic_net_grid</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="selecting-the-best-model" class="level3" data-number="4.8.4"><h3 data-number="4.8.4" class="anchored" data-anchor-id="selecting-the-best-model">
<span class="header-section-number">4.8.4</span> Selecting the Best Model</h3>
<p>After performing the grid search with cross-validation, we can evaluate which combination of <strong>penalty</strong> (and <strong>mixture</strong> for Elastic Net) provides the best model. We will use <strong>RMSE</strong> as the performance metric to select the best model.</p>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">best_lasso</span> <span class="op">=</span> <span class="fu">select_best</span><span class="op">(</span><span class="va">lasso_tune</span>,metric <span class="op">=</span>  <span class="st">"rmse"</span><span class="op">)</span></span>
<span><span class="va">best_lasso</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  penalty .config              
    &lt;dbl&gt; &lt;chr&gt;                
1    1.67 Preprocessor1_Model03</code></pre>
</div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">best_ridge</span> <span class="op">=</span> <span class="fu">select_best</span><span class="op">(</span><span class="va">ridge_tune</span>, metric <span class="op">=</span> <span class="st">"rmse"</span><span class="op">)</span></span>
<span><span class="va">best_ridge</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  penalty .config              
    &lt;dbl&gt; &lt;chr&gt;                
1    7.74 Preprocessor1_Model09</code></pre>
</div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">best_elastic_net</span> <span class="op">=</span> <span class="fu">select_best</span><span class="op">(</span><span class="va">elastic_net_tune</span>, metric <span class="op">=</span> <span class="st">"rmse"</span><span class="op">)</span></span>
<span><span class="va">best_elastic_net</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  penalty mixture .config               
    &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;                 
1    3.60   0.444 Preprocessor1_Model046</code></pre>
</div>
</div>
</section><section id="fitting-the-final-models" class="level3" data-number="4.8.5"><h3 data-number="4.8.5" class="anchored" data-anchor-id="fitting-the-final-models">
<span class="header-section-number">4.8.5</span> Fitting the Final Models</h3>
<p>After selecting the best hyperparameters, we can fit the final models using the optimal values for the <strong>penalty</strong> and <strong>mixture</strong> parameters.</p>
<section id="fitting-the-final-lasso-model" class="level4"><h4 class="anchored" data-anchor-id="fitting-the-final-lasso-model">Fitting the Final Lasso Model</h4>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">final_lasso_model</span> <span class="op">=</span> <span class="fu">linear_reg</span><span class="op">(</span>penalty <span class="op">=</span> <span class="va">best_lasso</span><span class="op">$</span><span class="va">penalty</span>, mixture <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_engine</span><span class="op">(</span><span class="st">"glmnet"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_mode</span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">final_lasso_fit</span> <span class="op">=</span> <span class="fu">fit</span><span class="op">(</span><span class="va">final_lasso_model</span>, <span class="va">Points</span> <span class="op">~</span> <span class="va">avgDriveDist</span> <span class="op">+</span> <span class="va">drivePct</span> <span class="op">+</span> <span class="va">driveSG</span> <span class="op">+</span> </span>
<span>                        <span class="va">avgPuttsPerRound</span> <span class="op">+</span> <span class="va">onePuttPct</span> <span class="op">+</span> <span class="va">puttsSG</span>, </span>
<span>                       data <span class="op">=</span> <span class="va">processed_train_data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">final_lasso_fit</span> <span class="op">|&gt;</span> <span class="fu">tidy</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 3
  term             estimate penalty
  &lt;chr&gt;               &lt;dbl&gt;   &lt;dbl&gt;
1 (Intercept)      43.6        1.67
2 avgDriveDist      0.00320    1.67
3 drivePct          0          1.67
4 driveSG          20.7        1.67
5 avgPuttsPerRound -2.83       1.67
6 onePuttPct        0          1.67
7 puttsSG          24.4        1.67</code></pre>
</div>
</div>
</section><section id="fitting-the-final-ridge-model" class="level4"><h4 class="anchored" data-anchor-id="fitting-the-final-ridge-model">Fitting the Final Ridge Model</h4>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">final_ridge_model</span> <span class="op">=</span> <span class="fu">linear_reg</span><span class="op">(</span>penalty <span class="op">=</span> <span class="va">best_ridge</span><span class="op">$</span><span class="va">penalty</span>, mixture <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_engine</span><span class="op">(</span><span class="st">"glmnet"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_mode</span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">final_ridge_fit</span> <span class="op">=</span> <span class="fu">fit</span><span class="op">(</span><span class="va">final_ridge_model</span>, <span class="va">Points</span> <span class="op">~</span> <span class="va">avgDriveDist</span> <span class="op">+</span> <span class="va">drivePct</span> <span class="op">+</span> <span class="va">driveSG</span> <span class="op">+</span> </span>
<span>                        <span class="va">avgPuttsPerRound</span> <span class="op">+</span> <span class="va">onePuttPct</span> <span class="op">+</span> <span class="va">puttsSG</span>, </span>
<span>                       data <span class="op">=</span> <span class="va">processed_train_data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">final_ridge_fit</span> <span class="op">|&gt;</span> <span class="fu">tidy</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 3
  term             estimate penalty
  &lt;chr&gt;               &lt;dbl&gt;   &lt;dbl&gt;
1 (Intercept)        43.6      7.74
2 avgDriveDist        2.56     7.74
3 drivePct            1.93     7.74
4 driveSG            19.1      7.74
5 avgPuttsPerRound   -5.46     7.74
6 onePuttPct         -0.392    7.74
7 puttsSG            22.6      7.74</code></pre>
</div>
</div>
</section><section id="fitting-the-final-elastic-net-model" class="level4"><h4 class="anchored" data-anchor-id="fitting-the-final-elastic-net-model">Fitting the Final Elastic Net Model</h4>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">final_elastic_net_model</span> <span class="op">=</span> <span class="fu">linear_reg</span><span class="op">(</span>penalty <span class="op">=</span> <span class="va">best_elastic_net</span><span class="op">$</span><span class="va">penalty</span>, </span>
<span>                                      mixture <span class="op">=</span> <span class="va">best_elastic_net</span><span class="op">$</span><span class="va">mixture</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_engine</span><span class="op">(</span><span class="st">"glmnet"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">set_mode</span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">final_elastic_net_fit</span> <span class="op">=</span> <span class="fu">fit</span><span class="op">(</span><span class="va">final_elastic_net_model</span>, <span class="va">Points</span> <span class="op">~</span> <span class="va">avgDriveDist</span> <span class="op">+</span> <span class="va">drivePct</span> <span class="op">+</span> <span class="va">driveSG</span> <span class="op">+</span> </span>
<span>                               <span class="va">avgPuttsPerRound</span> <span class="op">+</span> <span class="va">onePuttPct</span> <span class="op">+</span> <span class="va">puttsSG</span>, </span>
<span>                              data <span class="op">=</span> <span class="va">processed_train_data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">final_elastic_net_fit</span> <span class="op">|&gt;</span> <span class="fu">tidy</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 3
  term             estimate penalty
  &lt;chr&gt;               &lt;dbl&gt;   &lt;dbl&gt;
1 (Intercept)        43.6      3.60
2 avgDriveDist        0.176    3.60
3 drivePct            0        3.60
4 driveSG            20.2      3.60
5 avgPuttsPerRound   -3.14     3.60
6 onePuttPct          0        3.60
7 puttsSG            23.7      3.60</code></pre>
</div>
</div>
<p>Tuning the regularization parameters is an essential step in building a robust predictive model. By using cross-validation and grid search, we can find the optimal values for the <strong>penalty</strong> parameter (and <strong>mixture</strong> for Elastic Net), which helps us balance bias and variance effectively. The best model, based on the tuning results, should offer the most generalizable predictions for new data.</p>


</section></section></section></main><!-- /main --><script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Show Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Show Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  update_total_correct();
}

</script><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./03_Tidymodels.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Introduction to Tidymodels</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./05_Logistic.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Logistic Regression with Regularization</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">STA 3311</div>
  </div>
</footer>


</body></html>